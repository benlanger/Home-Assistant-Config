[
  {
    "id": "233ac7dcd801a802",
    "type": "subflow",
    "name": "Improved Alerts 1.0",
    "info": "",
    "category": "",
    "in": [
      {
        "x": 140,
        "y": 900,
        "wires": [
          {
            "id": "2d00197d6062613a"
          },
          {
            "id": "2fad2062613570e7"
          },
          {
            "id": "366af0d006ca31e2"
          }
        ]
      }
    ],
    "out": [],
    "env": [],
    "meta": {},
    "color": "#DDAA99"
  },
  {
    "id": "bfbfd266d4db3ff6",
    "type": "trigger",
    "z": "233ac7dcd801a802",
    "name": "Lights fuse",
    "op1": "",
    "op2": "",
    "op1type": "pay",
    "op2type": "nul",
    "duration": "10",
    "extend": false,
    "overrideDelay": false,
    "units": "s",
    "reset": "",
    "bytopic": "all",
    "topic": "topic",
    "outputs": 1,
    "x": 530,
    "y": 840,
    "wires": [
      [
        "a8a6083a8c86c955"
      ]
    ]
  },
  {
    "id": "d7fadd0a9fdb8db7",
    "type": "switch",
    "z": "233ac7dcd801a802",
    "name": "",
    "property": "message",
    "propertyType": "msg",
    "rules": [
      {
        "t": "nempty"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 1,
    "x": 470,
    "y": 1460,
    "wires": [
      [
        "93abfd0faa549add"
      ]
    ]
  },
  {
    "id": "2d00197d6062613a",
    "type": "trigger",
    "z": "233ac7dcd801a802",
    "name": "MEssage fuse",
    "op1": "",
    "op2": "",
    "op1type": "pay",
    "op2type": "nul",
    "duration": "10",
    "extend": false,
    "overrideDelay": false,
    "units": "s",
    "reset": "",
    "bytopic": "all",
    "topic": "topic",
    "outputs": 1,
    "x": 320,
    "y": 1460,
    "wires": [
      [
        "d7fadd0a9fdb8db7"
      ]
    ]
  },
  {
    "id": "2fad2062613570e7",
    "type": "trigger",
    "z": "233ac7dcd801a802",
    "name": "TV Fuse",
    "op1": "",
    "op2": "",
    "op1type": "pay",
    "op2type": "nul",
    "duration": "10",
    "extend": false,
    "overrideDelay": false,
    "units": "s",
    "reset": "",
    "bytopic": "all",
    "topic": "topic",
    "outputs": 1,
    "x": 440,
    "y": 640,
    "wires": [
      [
        "f62429ddd9325d05"
      ]
    ]
  },
  {
    "id": "366af0d006ca31e2",
    "type": "switch",
    "z": "233ac7dcd801a802",
    "name": "",
    "property": "color_value",
    "propertyType": "msg",
    "rules": [
      {
        "t": "nempty"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 1,
    "x": 310,
    "y": 900,
    "wires": [
      [
        "bfbfd266d4db3ff6"
      ]
    ]
  },
  {
    "id": "bf7d2f2b92acac90",
    "type": "api-current-state",
    "z": "233ac7dcd801a802",
    "name": "Living Room  TV?",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "playing",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "media_player.livingroom_chromecast",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [
      {
        "property": "input",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      }
    ],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 950,
    "y": 480,
    "wires": [
      [
        "1b5cdf8f1e17773d"
      ],
      [
        "b611fb8c2500ad1c"
      ]
    ]
  },
  {
    "id": "178917f15c37ce39",
    "type": "api-current-state",
    "z": "233ac7dcd801a802",
    "name": "Patio TV?",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "off",
    "halt_if_type": "str",
    "halt_if_compare": "is_not",
    "entity_id": "media_player.patio_chromecast",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 920,
    "y": 100,
    "wires": [
      [
        "83889f97b2da30fd"
      ],
      [
        "da32748bdce2049d"
      ]
    ]
  },
  {
    "id": "83889f97b2da30fd",
    "type": "change",
    "z": "233ac7dcd801a802",
    "name": "",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1160,
    "y": 100,
    "wires": [
      [
        "c47c0b6ee6e75dc7"
      ]
    ]
  },
  {
    "id": "c47c0b6ee6e75dc7",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "pause patio TV",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": true,
    "domain": "media_player",
    "service": "media_pause",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "media_player.patio_chromecast"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "data"
      }
    ],
    "queue": "none",
    "x": 1340,
    "y": 100,
    "wires": [
      []
    ]
  },
  {
    "id": "1b5cdf8f1e17773d",
    "type": "change",
    "z": "233ac7dcd801a802",
    "name": "",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1160,
    "y": 460,
    "wires": [
      [
        "1a229f2742b5b7c7"
      ]
    ]
  },
  {
    "id": "1a229f2742b5b7c7",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "pause living room tv",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": true,
    "domain": "media_player",
    "service": "media_pause",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "media_player.livingroom_chromecast"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "data"
      }
    ],
    "queue": "none",
    "x": 1360,
    "y": 460,
    "wires": [
      []
    ]
  },
  {
    "id": "b611fb8c2500ad1c",
    "type": "api-current-state",
    "z": "233ac7dcd801a802",
    "name": "Living Room LG?",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 1,
    "halt_if": "",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "media_player.living_room_lg",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [
      {
        "property": "input",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      }
    ],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 1170,
    "y": 500,
    "wires": [
      [
        "f84a71c80a329df7"
      ]
    ]
  },
  {
    "id": "f84a71c80a329df7",
    "type": "switch",
    "z": "233ac7dcd801a802",
    "name": "",
    "property": "payload.attributes.source",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "HDMI 2",
        "vt": "str"
      },
      {
        "t": "neq",
        "v": "HDMI 2",
        "vt": "str"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 2,
    "x": 1330,
    "y": 500,
    "wires": [
      [
        "dfc94fd3cd6d7d0a"
      ],
      [
        "eda23319b792cf54"
      ]
    ]
  },
  {
    "id": "97c68e4e60fb929b",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "stop",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "media_player",
    "service": "turn_off",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "media_player.livingroom_chromecast"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "data"
      }
    ],
    "queue": "none",
    "x": 2350,
    "y": 560,
    "wires": [
      []
    ]
  },
  {
    "id": "da32748bdce2049d",
    "type": "exec",
    "z": "233ac7dcd801a802",
    "command": "/root/.local/bin/catt -d 'Patio TV' cast_site 'http://192.168.0.15:8123/local/reolink.jpg'",
    "addpay": false,
    "append": "",
    "useSpawn": "false",
    "timer": "",
    "winHide": false,
    "oldrc": false,
    "name": "",
    "x": 1370,
    "y": 140,
    "wires": [
      [
        "d74b74afb767cedd"
      ],
      [],
      [
        "d74b74afb767cedd"
      ]
    ]
  },
  {
    "id": "d74b74afb767cedd",
    "type": "ha-wait-until",
    "z": "233ac7dcd801a802",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 2,
    "outputs": 2,
    "entityId": "lock.lock_front_door",
    "entityIdFilterType": "exact",
    "property": "state",
    "comparator": "is",
    "value": "unlocked",
    "valueType": "str",
    "timeout": "120",
    "timeoutType": "num",
    "timeoutUnits": "seconds",
    "checkCurrentState": false,
    "blockInputOverrides": true,
    "outputProperties": [],
    "x": 1880,
    "y": 140,
    "wires": [
      [
        "f168877252b94675"
      ],
      [
        "f168877252b94675"
      ]
    ]
  },
  {
    "id": "f168877252b94675",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "stop",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "media_player",
    "service": "turn_off",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "media_player.patio_chromecast"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "data"
      }
    ],
    "queue": "none",
    "x": 2090,
    "y": 140,
    "wires": [
      []
    ]
  },
  {
    "id": "e04a239b215f585b",
    "type": "api-current-state",
    "z": "233ac7dcd801a802",
    "name": "Hotbox TV Down",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "off",
    "halt_if_type": "str",
    "halt_if_compare": "is_not",
    "entity_id": "media_player.hotbox_down_chromecast",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 950,
    "y": 180,
    "wires": [
      [
        "49b3ba815ee85189"
      ],
      [
        "e1aed2ba45691dde"
      ]
    ]
  },
  {
    "id": "49b3ba815ee85189",
    "type": "change",
    "z": "233ac7dcd801a802",
    "name": "",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1160,
    "y": 180,
    "wires": [
      [
        "d0c96c0e8a77727a"
      ]
    ]
  },
  {
    "id": "d0c96c0e8a77727a",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "pause",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": true,
    "domain": "media_player",
    "service": "media_pause",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "media_player.hotbox_down_chromecast"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "data"
      }
    ],
    "queue": "none",
    "x": 1310,
    "y": 180,
    "wires": [
      []
    ]
  },
  {
    "id": "e1aed2ba45691dde",
    "type": "exec",
    "z": "233ac7dcd801a802",
    "command": "/root/.local/bin/catt -d 'Hotbox Top TV' cast_site 'http://192.168.0.15:8123/local/reolink.jpg'",
    "addpay": false,
    "append": "",
    "useSpawn": "false",
    "timer": "",
    "winHide": false,
    "oldrc": false,
    "name": "",
    "x": 1390,
    "y": 220,
    "wires": [
      [
        "9649f5547bece956"
      ],
      [],
      [
        "9649f5547bece956"
      ]
    ]
  },
  {
    "id": "9649f5547bece956",
    "type": "ha-wait-until",
    "z": "233ac7dcd801a802",
    "name": "lock opens",
    "server": "7ab5c227.a3ce8c",
    "version": 2,
    "outputs": 2,
    "entityId": "lock.lock_front_door, ",
    "entityIdFilterType": "exact",
    "property": "state",
    "comparator": "is",
    "value": "unlocked",
    "valueType": "str",
    "timeout": "120",
    "timeoutType": "num",
    "timeoutUnits": "seconds",
    "checkCurrentState": false,
    "blockInputOverrides": true,
    "outputProperties": [],
    "x": 1830,
    "y": 220,
    "wires": [
      [
        "aaddf35feb5a8563"
      ],
      [
        "aaddf35feb5a8563"
      ]
    ]
  },
  {
    "id": "aaddf35feb5a8563",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "stop",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "media_player",
    "service": "turn_off",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "media_player.hotbox_down_chromecast"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "data"
      }
    ],
    "queue": "none",
    "x": 2150,
    "y": 220,
    "wires": [
      []
    ]
  },
  {
    "id": "158c278da7a41073",
    "type": "api-current-state",
    "z": "233ac7dcd801a802",
    "name": "Hotbox TV",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "off",
    "halt_if_type": "str",
    "halt_if_compare": "is_not",
    "entity_id": "media_player.hotbox_top_chromecast",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 930,
    "y": 260,
    "wires": [
      [
        "79580208474f7ae3"
      ],
      [
        "0c49ca6c6b92d452"
      ]
    ]
  },
  {
    "id": "79580208474f7ae3",
    "type": "change",
    "z": "233ac7dcd801a802",
    "name": "",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1160,
    "y": 260,
    "wires": [
      [
        "e4b90b70cc03b2d3"
      ]
    ]
  },
  {
    "id": "e4b90b70cc03b2d3",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "pause",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": true,
    "domain": "media_player",
    "service": "media_pause",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "media_player.hotbox_top_chromecast"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "data"
      }
    ],
    "queue": "none",
    "x": 1310,
    "y": 260,
    "wires": [
      []
    ]
  },
  {
    "id": "0c49ca6c6b92d452",
    "type": "exec",
    "z": "233ac7dcd801a802",
    "command": "/root/.local/bin/catt -d 'Hotbox Down TV' cast_site 'http://192.168.0.15:8123/local/reolink.jpg'",
    "addpay": false,
    "append": "",
    "useSpawn": "false",
    "timer": "",
    "winHide": false,
    "oldrc": false,
    "name": "",
    "x": 1400,
    "y": 300,
    "wires": [
      [
        "10a6fcba37970a19"
      ],
      [],
      [
        "10a6fcba37970a19"
      ]
    ]
  },
  {
    "id": "10a6fcba37970a19",
    "type": "ha-wait-until",
    "z": "233ac7dcd801a802",
    "name": "lock opens",
    "server": "7ab5c227.a3ce8c",
    "version": 2,
    "outputs": 2,
    "entityId": "lock.lock_front_door, ",
    "entityIdFilterType": "exact",
    "property": "state",
    "comparator": "is",
    "value": "unlocked",
    "valueType": "str",
    "timeout": "120",
    "timeoutType": "num",
    "timeoutUnits": "seconds",
    "checkCurrentState": false,
    "blockInputOverrides": true,
    "outputProperties": [],
    "x": 1830,
    "y": 300,
    "wires": [
      [
        "fb7e21f4de7de77a"
      ],
      [
        "fb7e21f4de7de77a"
      ]
    ]
  },
  {
    "id": "fb7e21f4de7de77a",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "stop",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "media_player",
    "service": "turn_off",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "media_player.hotbox_top_chromecast"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "data"
      }
    ],
    "queue": "none",
    "x": 2150,
    "y": 300,
    "wires": [
      []
    ]
  },
  {
    "id": "5d7c0bbeb450ee8f",
    "type": "api-current-state",
    "z": "233ac7dcd801a802",
    "name": "Bedroom TV",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "idle",
    "halt_if_type": "str",
    "halt_if_compare": "is_not",
    "entity_id": "media_player.bedroom_chromecast",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 930,
    "y": 360,
    "wires": [
      [
        "8ca4f5e04813679b"
      ],
      [
        "aa5449613c09ed95"
      ]
    ]
  },
  {
    "id": "8ca4f5e04813679b",
    "type": "change",
    "z": "233ac7dcd801a802",
    "name": "",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1160,
    "y": 360,
    "wires": [
      [
        "12caa4d321f7d9b7"
      ]
    ]
  },
  {
    "id": "12caa4d321f7d9b7",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "pause",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": true,
    "domain": "media_player",
    "service": "media_pause",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "media_player.bedroom_chromecast"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "data"
      }
    ],
    "queue": "none",
    "x": 1310,
    "y": 360,
    "wires": [
      []
    ]
  },
  {
    "id": "aa5449613c09ed95",
    "type": "exec",
    "z": "233ac7dcd801a802",
    "command": "/root/.local/bin/catt -d 'Bedroom TV' cast_site 'http://192.168.0.15:8123/local/reolink.jpg'",
    "addpay": false,
    "append": "",
    "useSpawn": "false",
    "timer": "",
    "winHide": false,
    "oldrc": false,
    "name": "",
    "x": 1380,
    "y": 400,
    "wires": [
      [
        "772fa04af2eddebf"
      ],
      [],
      [
        "772fa04af2eddebf"
      ]
    ]
  },
  {
    "id": "4f565ee6c651e601",
    "type": "ha-wait-until",
    "z": "233ac7dcd801a802",
    "name": "lock opens",
    "server": "7ab5c227.a3ce8c",
    "version": 2,
    "outputs": 2,
    "entityId": "lock.lock_front_door",
    "entityIdFilterType": "exact",
    "property": "state",
    "comparator": "is",
    "value": "unlocked",
    "valueType": "str",
    "timeout": "120",
    "timeoutType": "num",
    "timeoutUnits": "seconds",
    "checkCurrentState": false,
    "blockInputOverrides": true,
    "outputProperties": [],
    "x": 2010,
    "y": 400,
    "wires": [
      [
        "464fea57697c8ec1"
      ],
      [
        "464fea57697c8ec1"
      ]
    ]
  },
  {
    "id": "464fea57697c8ec1",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "stop",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "media_player",
    "service": "turn_off",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "media_player.bedroom_chromecast"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 2190,
    "y": 380,
    "wires": [
      [
        "41dc25cd3027a91b"
      ]
    ]
  },
  {
    "id": "dfc94fd3cd6d7d0a",
    "type": "exec",
    "z": "233ac7dcd801a802",
    "command": "/root/.local/bin/catt -d 'Living Room TV' cast_site 'http://192.168.0.15:8123/local/reolink.jpg'",
    "addpay": false,
    "append": "",
    "useSpawn": "false",
    "timer": "",
    "winHide": false,
    "oldrc": false,
    "name": "",
    "x": 1730,
    "y": 500,
    "wires": [
      [
        "ba1ee1d7102dc2a3"
      ],
      [],
      []
    ]
  },
  {
    "id": "ba1ee1d7102dc2a3",
    "type": "ha-wait-until",
    "z": "233ac7dcd801a802",
    "name": "lock opens",
    "server": "7ab5c227.a3ce8c",
    "version": 2,
    "outputs": 2,
    "entityId": "lock.lock_front_door, ",
    "entityIdFilterType": "exact",
    "property": "state",
    "comparator": "is",
    "value": "unlocked",
    "valueType": "str",
    "timeout": "120",
    "timeoutType": "num",
    "timeoutUnits": "seconds",
    "checkCurrentState": false,
    "blockInputOverrides": true,
    "outputProperties": [],
    "x": 2190,
    "y": 500,
    "wires": [
      [
        "7707fca3eae09981"
      ],
      [
        "7707fca3eae09981"
      ]
    ]
  },
  {
    "id": "7707fca3eae09981",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "stop",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "media_player",
    "service": "turn_off",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "media_player.livingroom_chromecast"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "data"
      }
    ],
    "queue": "none",
    "x": 2350,
    "y": 500,
    "wires": [
      [
        "f971d0de1bc27714"
      ]
    ]
  },
  {
    "id": "eda23319b792cf54",
    "type": "exec",
    "z": "233ac7dcd801a802",
    "command": "/root/.local/bin/catt -d 'Living Room TV' cast_site 'http://192.168.0.15:8123/local/reolink.jpg'",
    "addpay": false,
    "append": "",
    "useSpawn": "false",
    "timer": "",
    "winHide": false,
    "oldrc": false,
    "name": "",
    "x": 1730,
    "y": 560,
    "wires": [
      [
        "cf6628393222d924"
      ],
      [],
      []
    ]
  },
  {
    "id": "cf6628393222d924",
    "type": "ha-wait-until",
    "z": "233ac7dcd801a802",
    "name": "lock opens",
    "server": "7ab5c227.a3ce8c",
    "version": 2,
    "outputs": 2,
    "entityId": "lock.lock_front_door",
    "entityIdFilterType": "exact",
    "property": "state",
    "comparator": "is",
    "value": "unlocked",
    "valueType": "str",
    "timeout": "120",
    "timeoutType": "num",
    "timeoutUnits": "seconds",
    "checkCurrentState": false,
    "blockInputOverrides": true,
    "outputProperties": [],
    "x": 2190,
    "y": 560,
    "wires": [
      [
        "97c68e4e60fb929b"
      ],
      [
        "97c68e4e60fb929b"
      ]
    ]
  },
  {
    "id": "f971d0de1bc27714",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "change source",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "media_player",
    "service": "select_source",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "media_player.living_room_lg"
    ],
    "data": "{\"source\":\"HDMI 2\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "data"
      }
    ],
    "queue": "none",
    "x": 2500,
    "y": 500,
    "wires": [
      []
    ]
  },
  {
    "id": "41dc25cd3027a91b",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "change source",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "media_player",
    "service": "select_source",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "media_player.bedroom_tv"
    ],
    "data": "{\"source\":\"PC\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "data"
      }
    ],
    "queue": "none",
    "x": 2520,
    "y": 380,
    "wires": [
      []
    ]
  },
  {
    "id": "772fa04af2eddebf",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "change source",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "media_player",
    "service": "lock.lock_front_door, ",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "media_player.bedroom_tv"
    ],
    "data": "{\"source\":\"chromecast\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 1820,
    "y": 420,
    "wires": [
      [
        "4f565ee6c651e601"
      ]
    ]
  },
  {
    "id": "661df899720949f1",
    "type": "api-current-state",
    "z": "233ac7dcd801a802",
    "name": "Party",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "off",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "input_boolean.party_mode",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 730,
    "y": 240,
    "wires": [
      [
        "178917f15c37ce39",
        "e04a239b215f585b",
        "158c278da7a41073",
        "5d7c0bbeb450ee8f",
        "bf7d2f2b92acac90"
      ],
      []
    ]
  },
  {
    "id": "09496c934e88c4f4",
    "type": "api-current-state",
    "z": "233ac7dcd801a802",
    "name": "Party",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "off",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "input_boolean.kink_party",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 590,
    "y": 240,
    "wires": [
      [
        "661df899720949f1"
      ],
      []
    ]
  },
  {
    "id": "f62429ddd9325d05",
    "type": "switch",
    "z": "233ac7dcd801a802",
    "name": "",
    "property": "video",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "on",
        "vt": "str"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 1,
    "x": 530,
    "y": 520,
    "wires": [
      [
        "09496c934e88c4f4"
      ]
    ]
  },
  {
    "id": "aae981aced5c3ffa",
    "type": "function",
    "z": "233ac7dcd801a802",
    "name": " Set payload for play media ",
    "func": "var msg = {\n    \"payload\":\n      {\"data\": {\n      \"message\":  msg.message\n}}\n\n}\nreturn msg;",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 1080,
    "y": 1460,
    "wires": [
      [
        "61a99395152c0e79"
      ]
    ]
  },
  {
    "id": "a8a6083a8c86c955",
    "type": "ha-get-entities",
    "z": "233ac7dcd801a802",
    "name": "Get Lights",
    "server": "7ab5c227.a3ce8c",
    "version": 0,
    "rules": [
      {
        "property": "entity_id",
        "logic": "is",
        "value": "^light(?!.*?door.*?)(?!.*?group.*?)(?!.*?k95_rgb_2_led.*?)(?!.*?lights.*?).*[a-z].*(?<!s)$",
        "valueType": "re"
      },
      {
        "property": "state",
        "logic": "is_not",
        "value": "unavailable",
        "valueType": "str"
      }
    ],
    "output_type": "split",
    "output_empty_results": false,
    "output_location_type": "msg",
    "output_location": "payload",
    "output_results_count": 1,
    "x": 950,
    "y": 880,
    "wires": [
      [
        "034a2839d16f1399"
      ]
    ]
  },
  {
    "id": "034a2839d16f1399",
    "type": "switch",
    "z": "233ac7dcd801a802",
    "name": "Check color support",
    "property": "payload.attributes.supported_color_modes",
    "propertyType": "msg",
    "rules": [
      {
        "t": "cont",
        "v": "xy",
        "vt": "str"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 1,
    "x": 1160,
    "y": 880,
    "wires": [
      [
        "7f4b36bf2feb4669"
      ]
    ]
  },
  {
    "id": "7f4b36bf2feb4669",
    "type": "switch",
    "z": "233ac7dcd801a802",
    "name": "Check initial light state",
    "property": "payload.state",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "on",
        "vt": "str"
      },
      {
        "t": "eq",
        "v": "off",
        "vt": "str"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 2,
    "x": 1440,
    "y": 880,
    "wires": [
      [
        "b44c7449af1ef506"
      ],
      [
        "78c8f3f8edd7aa43"
      ]
    ]
  },
  {
    "id": "07ecb0bec4f1f33d",
    "type": "comment",
    "z": "233ac7dcd801a802",
    "name": "Pull all individual lights",
    "info": "",
    "x": 920,
    "y": 840,
    "wires": []
  },
  {
    "id": "beacf96bb661fbc2",
    "type": "comment",
    "z": "233ac7dcd801a802",
    "name": "Check if they support color",
    "info": "",
    "x": 1170,
    "y": 840,
    "wires": []
  },
  {
    "id": "e34bfbd72ae412d4",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "Change Lights",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "light",
    "service": "turn_on",
    "areaId": [],
    "deviceId": [],
    "entityId": [],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 1900,
    "y": 840,
    "wires": [
      [
        "dc4a72805e937312"
      ]
    ]
  },
  {
    "id": "b44c7449af1ef506",
    "type": "change",
    "z": "233ac7dcd801a802",
    "name": "Set desired Values",
    "rules": [
      {
        "t": "set",
        "p": "payload.data.rgb_color",
        "pt": "msg",
        "to": "color_value",
        "tot": "msg",
        "dc": true
      },
      {
        "t": "set",
        "p": "payload.data.brightness_pct",
        "pt": "msg",
        "to": "dbrigthness",
        "tot": "msg",
        "dc": true
      },
      {
        "t": "set",
        "p": "payload.data.entity_id",
        "pt": "msg",
        "to": "payload.entity_id",
        "tot": "msg"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1670,
    "y": 840,
    "wires": [
      [
        "e34bfbd72ae412d4"
      ]
    ]
  },
  {
    "id": "b71d1ddde35c7c33",
    "type": "change",
    "z": "233ac7dcd801a802",
    "name": "Set Initial color",
    "rules": [
      {
        "t": "delete",
        "p": "payload.data.brightness_pct",
        "pt": "msg"
      },
      {
        "t": "set",
        "p": "payload.data.rgb_color",
        "pt": "msg",
        "to": "payload.attributes.rgb_color",
        "tot": "msg",
        "dc": true
      },
      {
        "t": "set",
        "p": "payload.data.brightness",
        "pt": "msg",
        "to": "payload.attributes.brightness",
        "tot": "msg",
        "dc": true
      },
      {
        "t": "set",
        "p": "payload.data.entity_id",
        "pt": "msg",
        "to": "payload.entity_id",
        "tot": "msg",
        "dc": true
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 2380,
    "y": 840,
    "wires": [
      [
        "7068646d68382b1f"
      ]
    ]
  },
  {
    "id": "7068646d68382b1f",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "Change Lights",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "light",
    "service": "turn_on",
    "areaId": [],
    "deviceId": [],
    "entityId": [],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 2600,
    "y": 840,
    "wires": [
      []
    ]
  },
  {
    "id": "dc4a72805e937312",
    "type": "delay",
    "z": "233ac7dcd801a802",
    "name": "",
    "pauseType": "delay",
    "timeout": "3",
    "timeoutUnits": "seconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "second",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": false,
    "allowrate": false,
    "outputs": 1,
    "x": 2160,
    "y": 840,
    "wires": [
      [
        "b71d1ddde35c7c33"
      ]
    ]
  },
  {
    "id": "2068eafd7c4838ef",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "Change Lights",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "light",
    "service": "",
    "areaId": [],
    "deviceId": [],
    "entityId": [],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 2900,
    "y": 740,
    "wires": [
      [
        "ad2b99dbad3094c3"
      ]
    ]
  },
  {
    "id": "ad2b99dbad3094c3",
    "type": "api-current-state",
    "z": "233ac7dcd801a802",
    "name": "light.nate_ceiling_light",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 1,
    "halt_if": "",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "light.nate_ceiling_light",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      },
      {
        "property": "data",
        "propertyType": "msg",
        "value": "",
        "valueType": "entity"
      }
    ],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "override_topic": false,
    "state_location": "payload",
    "override_payload": "msg",
    "entity_location": "data",
    "override_data": "msg",
    "x": 2920,
    "y": 820,
    "wires": [
      [
        "03261b357f39059e"
      ]
    ]
  },
  {
    "id": "03261b357f39059e",
    "type": "switch",
    "z": "233ac7dcd801a802",
    "name": "!=same color",
    "property": "data.attributes.rgb_color",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "color_value",
        "vt": "msg"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 1,
    "x": 2910,
    "y": 780,
    "wires": [
      [
        "2068eafd7c4838ef"
      ]
    ]
  },
  {
    "id": "b00729f34334e07c",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "Change Lights",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "light",
    "service": "turn_on",
    "areaId": [],
    "deviceId": [],
    "entityId": [],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 1900,
    "y": 920,
    "wires": [
      [
        "70258176652e91f7"
      ]
    ]
  },
  {
    "id": "78c8f3f8edd7aa43",
    "type": "change",
    "z": "233ac7dcd801a802",
    "name": "Set desired Values",
    "rules": [
      {
        "t": "set",
        "p": "payload.data.rgb_color",
        "pt": "msg",
        "to": "color_value",
        "tot": "msg",
        "dc": true
      },
      {
        "t": "set",
        "p": "payload.data.brightness_pct",
        "pt": "msg",
        "to": "dbrigthness",
        "tot": "msg",
        "dc": true
      },
      {
        "t": "set",
        "p": "payload.data.entity_id",
        "pt": "msg",
        "to": "payload.entity_id",
        "tot": "msg"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1670,
    "y": 920,
    "wires": [
      [
        "b00729f34334e07c"
      ]
    ]
  },
  {
    "id": "0cede15e04a1f947",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "Turn off lights",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "light",
    "service": "turn_off",
    "areaId": [],
    "deviceId": [],
    "entityId": [],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 2580,
    "y": 920,
    "wires": [
      []
    ]
  },
  {
    "id": "70258176652e91f7",
    "type": "delay",
    "z": "233ac7dcd801a802",
    "name": "",
    "pauseType": "delay",
    "timeout": "3",
    "timeoutUnits": "seconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "second",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": false,
    "allowrate": false,
    "outputs": 1,
    "x": 2160,
    "y": 920,
    "wires": [
      [
        "3808b692f02d438e"
      ]
    ]
  },
  {
    "id": "3808b692f02d438e",
    "type": "change",
    "z": "233ac7dcd801a802",
    "name": "Set entity",
    "rules": [
      {
        "t": "set",
        "p": "payload.data.entity_id",
        "pt": "msg",
        "to": "payload.entity_id",
        "tot": "msg",
        "dc": true
      },
      {
        "t": "delete",
        "p": "payload.data.rgb_color",
        "pt": "msg"
      },
      {
        "t": "delete",
        "p": "payload.data.brightness_pct",
        "pt": "msg"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 2380,
    "y": 920,
    "wires": [
      [
        "0cede15e04a1f947"
      ]
    ]
  },
  {
    "id": "acc1eafbadde8fb3",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "notify",
    "service": "google_assistant_sdk",
    "areaId": [],
    "deviceId": [],
    "entityId": [],
    "data": "",
    "dataType": "jsonata",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 1580,
    "y": 1460,
    "wires": [
      []
    ]
  },
  {
    "id": "93abfd0faa549add",
    "type": "api-current-state",
    "z": "233ac7dcd801a802",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "off",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "input_boolean.kink_party",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      },
      {
        "property": "data",
        "propertyType": "msg",
        "value": "",
        "valueType": "entity"
      }
    ],
    "for": "0",
    "forType": "num",
    "forUnits": "minutes",
    "override_topic": false,
    "state_location": "payload",
    "override_payload": "msg",
    "entity_location": "data",
    "override_data": "msg",
    "x": 740,
    "y": 1460,
    "wires": [
      [
        "aae981aced5c3ffa"
      ],
      [
        "b582a2a18525713b"
      ]
    ]
  },
  {
    "id": "6274bd5a24a8990c",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "notify",
    "service": "google_assistant_sdk",
    "areaId": [],
    "deviceId": [],
    "entityId": [],
    "data": "",
    "dataType": "jsonata",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 2020,
    "y": 1540,
    "wires": [
      [
        "6384cc5b8ba49170"
      ]
    ]
  },
  {
    "id": "2420d649f87fe268",
    "type": "function",
    "z": "233ac7dcd801a802",
    "name": " Set payload for play media on entrace speaker",
    "func": "var msg = {\n    \"payload\":\n      {\"data\": {\n      \"message\":  msg.message,\n      \"target\": \"entrance speaker\"\n}}\n\n}\nreturn msg;",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 1480,
    "y": 1540,
    "wires": [
      [
        "be421a891fdd6f15"
      ]
    ]
  },
  {
    "id": "be421a891fdd6f15",
    "type": "trigger",
    "z": "233ac7dcd801a802",
    "name": "",
    "op1": "",
    "op2": "",
    "op1type": "nul",
    "op2type": "pay",
    "duration": "500",
    "extend": false,
    "overrideDelay": false,
    "units": "ms",
    "reset": "",
    "bytopic": "all",
    "topic": "topic",
    "outputs": 1,
    "x": 1780,
    "y": 1540,
    "wires": [
      [
        "6274bd5a24a8990c"
      ]
    ]
  },
  {
    "id": "61a99395152c0e79",
    "type": "trigger",
    "z": "233ac7dcd801a802",
    "name": "",
    "op1": "",
    "op2": "",
    "op1type": "nul",
    "op2type": "pay",
    "duration": "500",
    "extend": false,
    "overrideDelay": false,
    "units": "ms",
    "reset": "",
    "bytopic": "all",
    "topic": "topic",
    "outputs": 1,
    "x": 1320,
    "y": 1460,
    "wires": [
      [
        "acc1eafbadde8fb3"
      ]
    ]
  },
  {
    "id": "ab3a878cd76788e7",
    "type": "comment",
    "z": "233ac7dcd801a802",
    "name": "500ms delay as the assistant callback seems to bug everything down",
    "info": "",
    "x": 1320,
    "y": 1420,
    "wires": []
  },
  {
    "id": "b582a2a18525713b",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "set volume 100%",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "media_player",
    "service": "volume_set",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "media_player.hallway_speaker"
    ],
    "data": "{\"volume_level\": 10}",
    "dataType": "jsonata",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 1050,
    "y": 1540,
    "wires": [
      [
        "2420d649f87fe268"
      ]
    ]
  },
  {
    "id": "6384cc5b8ba49170",
    "type": "api-call-service",
    "z": "233ac7dcd801a802",
    "name": "set volume 30%",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "media_player",
    "service": "volume_set",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "media_player.hallway_speaker"
    ],
    "data": "{\"volume_level\": 3}",
    "dataType": "jsonata",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 2280,
    "y": 1540,
    "wires": [
      []
    ]
  }
]