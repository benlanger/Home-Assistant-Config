[
  {
    "id": "cd7a606d7931c143",
    "type": "tab",
    "label": "Face reco 10.0",
    "disabled": true,
    "info": "",
    "env": []
  },
  {
    "id": "d5035d7a4b8abde0",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 1320,
    "y": 700,
    "wires": [
      [
        "b1c8c154f909e20e"
      ]
    ]
  },
  {
    "id": "e8ce77d8da41bd8e",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 1320,
    "y": 740,
    "wires": [
      [
        "7ea8405b5138a79a"
      ]
    ]
  },
  {
    "id": "b1c8c154f909e20e",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 1420,
    "y": 700,
    "wires": [
      [
        "8a86d116cbd23a0c"
      ]
    ]
  },
  {
    "id": "7ea8405b5138a79a",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 1420,
    "y": 740,
    "wires": [
      [
        "7755d95655d67413"
      ]
    ]
  },
  {
    "id": "f1e47b926b68837c",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2600,
    "y": 720,
    "wires": [
      [
        "6d399809f46da187"
      ]
    ]
  },
  {
    "id": "0f8df3cecc7769a3",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2620,
    "y": 760,
    "wires": [
      [
        "de1538bda5a59999"
      ]
    ]
  },
  {
    "id": "6d399809f46da187",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2700,
    "y": 720,
    "wires": [
      [
        "84662acf4451979c"
      ]
    ]
  },
  {
    "id": "de1538bda5a59999",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2700,
    "y": 760,
    "wires": [
      [
        "fdc333b7d683f18c"
      ]
    ]
  },
  {
    "id": "a4c688e86f5f2b80",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3260,
    "y": 660,
    "wires": [
      [
        "acdce7f00366b401",
        "116f7fc3f104a266"
      ]
    ]
  },
  {
    "id": "79ea6e5eebeb3dc4",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 1840,
    "y": 660,
    "wires": [
      [
        "a338a4e199a28d06"
      ]
    ]
  },
  {
    "id": "a338a4e199a28d06",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 1940,
    "y": 660,
    "wires": [
      [
        "a4c688e86f5f2b80"
      ]
    ]
  },
  {
    "id": "1d8a1bf5c390d165",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 1840,
    "y": 740,
    "wires": [
      [
        "7755d95655d67413"
      ]
    ]
  },
  {
    "id": "94e15e45a5dd4895",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3140,
    "y": 700,
    "wires": [
      [
        "c177ff1a1286070d"
      ]
    ]
  },
  {
    "id": "13611f4c75079d74",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3140,
    "y": 740,
    "wires": [
      [
        "b85c085ce5640b8f"
      ]
    ]
  },
  {
    "id": "c177ff1a1286070d",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3220,
    "y": 700,
    "wires": [
      [
        "a4c688e86f5f2b80"
      ]
    ]
  },
  {
    "id": "b85c085ce5640b8f",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3240,
    "y": 740,
    "wires": [
      [
        "fdc333b7d683f18c"
      ]
    ]
  },
  {
    "id": "fdc333b7d683f18c",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3280,
    "y": 760,
    "wires": [
      [
        "5eb7dc5f5129f6ab"
      ]
    ]
  },
  {
    "id": "aeb41a7bbfd5f871",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3880,
    "y": 680,
    "wires": [
      [
        "8f42a1e376b2f151"
      ]
    ]
  },
  {
    "id": "f152504f7838b65f",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3840,
    "y": 680,
    "wires": [
      [
        "8f42a1e376b2f151"
      ]
    ]
  },
  {
    "id": "eca51006f7ccf6da",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3980,
    "y": 620,
    "wires": [
      [
        "622b280fd9e0e6f8"
      ]
    ]
  },
  {
    "id": "622b280fd9e0e6f8",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 4000,
    "y": 640,
    "wires": [
      [
        "9be2f214cabf3c56"
      ]
    ]
  },
  {
    "id": "d0547b86a59e926f",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3400,
    "y": 740,
    "wires": [
      [
        "5eb7dc5f5129f6ab"
      ]
    ]
  },
  {
    "id": "5eb7dc5f5129f6ab",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3440,
    "y": 760,
    "wires": [
      [
        "30eb2da0228e52db"
      ]
    ]
  },
  {
    "id": "625b7fb50bb7a849",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3340,
    "y": 740,
    "wires": [
      [
        "d0547b86a59e926f"
      ]
    ]
  },
  {
    "id": "25b0a99477e639be",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3580,
    "y": 740,
    "wires": [
      [
        "30eb2da0228e52db"
      ]
    ]
  },
  {
    "id": "30eb2da0228e52db",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3620,
    "y": 760,
    "wires": [
      [
        "0cc845d13352c21f"
      ]
    ]
  },
  {
    "id": "78575bad96d21598",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3520,
    "y": 740,
    "wires": [
      [
        "25b0a99477e639be"
      ]
    ]
  },
  {
    "id": "f8f4dd1f5ea9eeb9",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3760,
    "y": 740,
    "wires": [
      [
        "0cc845d13352c21f"
      ]
    ]
  },
  {
    "id": "0cc845d13352c21f",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3800,
    "y": 760,
    "wires": [
      [
        "759704f763b58501"
      ]
    ]
  },
  {
    "id": "f9d1114c3060999d",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3700,
    "y": 740,
    "wires": [
      [
        "f8f4dd1f5ea9eeb9"
      ]
    ]
  },
  {
    "id": "e6e258ae376ae884",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 4120,
    "y": 700,
    "wires": [
      [
        "759704f763b58501"
      ]
    ]
  },
  {
    "id": "56d369d20406df30",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 1720,
    "y": 3160,
    "wires": [
      [
        "1e3bb9f8806d7431"
      ]
    ]
  },
  {
    "id": "e9d9c66b8213d739",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 1720,
    "y": 3200,
    "wires": [
      [
        "21b410282eca03ed"
      ]
    ]
  },
  {
    "id": "1e3bb9f8806d7431",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 1820,
    "y": 3160,
    "wires": [
      [
        "923786bcd627d0aa"
      ]
    ]
  },
  {
    "id": "21b410282eca03ed",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 1820,
    "y": 3200,
    "wires": [
      [
        "a3210f29da2f7d89"
      ]
    ]
  },
  {
    "id": "a6b3d72c6c7dcaa9",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2220,
    "y": 3100,
    "wires": [
      [
        "a1af7a8ad1fdea77",
        "379e425db7a8a166"
      ]
    ]
  },
  {
    "id": "11605bc3d4a5768c",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2100,
    "y": 3140,
    "wires": [
      [
        "99b945bcd39a6a1f"
      ]
    ]
  },
  {
    "id": "a3210f29da2f7d89",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2100,
    "y": 3180,
    "wires": [
      [
        "6f8512591cd914ad"
      ]
    ]
  },
  {
    "id": "99b945bcd39a6a1f",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2180,
    "y": 3140,
    "wires": [
      [
        "a6b3d72c6c7dcaa9"
      ]
    ]
  },
  {
    "id": "6f8512591cd914ad",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2200,
    "y": 3180,
    "wires": [
      [
        "04c88a4ffc92e643"
      ]
    ]
  },
  {
    "id": "04c88a4ffc92e643",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2240,
    "y": 3200,
    "wires": [
      [
        "dfa3c38e278ecc95"
      ]
    ]
  },
  {
    "id": "fc3459aea7ead35e",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2840,
    "y": 3120,
    "wires": [
      [
        "839c614fc03c226c"
      ]
    ]
  },
  {
    "id": "8b8cbeaffef4fdea",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2800,
    "y": 3120,
    "wires": [
      [
        "839c614fc03c226c"
      ]
    ]
  },
  {
    "id": "19ba7309e15502d7",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2940,
    "y": 3060,
    "wires": [
      [
        "187a0a6344189bac"
      ]
    ]
  },
  {
    "id": "187a0a6344189bac",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2960,
    "y": 3080,
    "wires": [
      [
        "a58003ac74cf89ee"
      ]
    ]
  },
  {
    "id": "684740a4e3873dd8",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2360,
    "y": 3180,
    "wires": [
      [
        "dfa3c38e278ecc95"
      ]
    ]
  },
  {
    "id": "dfa3c38e278ecc95",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2400,
    "y": 3200,
    "wires": [
      [
        "c7838a406c9eb277"
      ]
    ]
  },
  {
    "id": "749f9097f018277c",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2300,
    "y": 3180,
    "wires": [
      [
        "684740a4e3873dd8"
      ]
    ]
  },
  {
    "id": "a95e22cb2f83dcda",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2540,
    "y": 3180,
    "wires": [
      [
        "c7838a406c9eb277"
      ]
    ]
  },
  {
    "id": "c7838a406c9eb277",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2580,
    "y": 3200,
    "wires": [
      [
        "f019076abe11d954"
      ]
    ]
  },
  {
    "id": "c942ac776d6cd71f",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2480,
    "y": 3180,
    "wires": [
      [
        "a95e22cb2f83dcda"
      ]
    ]
  },
  {
    "id": "413d4ec9a6df11df",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2720,
    "y": 3180,
    "wires": [
      [
        "f019076abe11d954"
      ]
    ]
  },
  {
    "id": "f019076abe11d954",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2760,
    "y": 3200,
    "wires": [
      [
        "929ec49d77f1d265"
      ]
    ]
  },
  {
    "id": "da73e5a65b916aaa",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 2660,
    "y": 3180,
    "wires": [
      [
        "413d4ec9a6df11df"
      ]
    ]
  },
  {
    "id": "d1d80e74b4721828",
    "type": "junction",
    "z": "cd7a606d7931c143",
    "x": 3080,
    "y": 3140,
    "wires": [
      [
        "929ec49d77f1d265"
      ]
    ]
  },
  {
    "id": "8356b51a9007c3b7",
    "type": "http request",
    "z": "cd7a606d7931c143",
    "name": "POST request with link to current image on faceshot camera",
    "method": "GET",
    "ret": "obj",
    "paytoqs": "ignore",
    "url": "http://192.168.0.14:3000/api/recognize?url=http://192.168.0.14:5000/api/faceshot_camera/latest.jpg?quality=100",
    "tls": "",
    "persist": false,
    "proxy": "",
    "insecureHTTPParser": false,
    "authType": "",
    "senderr": false,
    "headers": [],
    "x": 580,
    "y": 720,
    "wires": [
      [
        "9d26e1a43b7468d6",
        "3654de3dfbdb6a8c"
      ]
    ]
  },
  {
    "id": "ce230f98044f9ce1",
    "type": "trigger",
    "z": "cd7a606d7931c143",
    "name": "2 minutes",
    "op1": "",
    "op2": "",
    "op1type": "pay",
    "op2type": "nul",
    "duration": "2",
    "extend": false,
    "overrideDelay": false,
    "units": "min",
    "reset": "",
    "bytopic": "all",
    "topic": "topic",
    "outputs": 1,
    "x": 200,
    "y": 720,
    "wires": [
      [
        "757ceece5ae2a82f",
        "8356b51a9007c3b7",
        "5197a8dcb4f7e262"
      ]
    ]
  },
  {
    "id": "acdce7f00366b401",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "debug 196",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 3390,
    "y": 600,
    "wires": []
  },
  {
    "id": "ebe93d01362801ad",
    "type": "inject",
    "z": "cd7a606d7931c143",
    "name": "",
    "props": [
      {
        "p": "payload"
      },
      {
        "p": "data",
        "v": "{\"entity_id\":\"sensor.remote_doorbell_button_action\",\"old_state\":{\"entity_id\":\"sensor.remote_doorbell_button_action\",\"state\":\"None\",\"attributes\":{\"action\":null,\"battery\":88,\"click\":\"\",\"device\":{\"applicationVersion\":10,\"dateCode\":\"20150424\",\"friendlyName\":\"remote_doorbell_button\",\"hardwareVersion\":2,\"ieeeAddr\":\"0x00158d000210d4d2\",\"manufacturerID\":4151,\"manufacturerName\":\"LUMI\",\"model\":\"WXKG01LM\",\"networkAddress\":36077,\"powerSource\":\"Battery\",\"softwareBuildID\":\"3000-0001\",\"stackVersion\":2,\"type\":\"EndDevice\"},\"linkquality\":47,\"power_outage_count\":78,\"voltage\":2982,\"icon\":\"mdi:gesture-double-tap\",\"friendly_name\":\"remote_doorbell_button_action\"},\"last_changed\":\"2023-02-24T23:35:13.214676+00:00\",\"last_updated\":\"2023-02-24T23:35:13.214676+00:00\",\"context\":{\"id\":\"01GT2WFQ1Y1GVKCW3ZJV32CPDN\",\"parent_id\":null,\"user_id\":null},\"original_state\":\"None\"},\"new_state\":{\"entity_id\":\"sensor.remote_doorbell_button_action\",\"state\":\"single\",\"attributes\":{\"action\":\"single\",\"battery\":88,\"click\":null,\"device\":{\"applicationVersion\":10,\"dateCode\":\"20150424\",\"friendlyName\":\"remote_doorbell_button\",\"hardwareVersion\":2,\"ieeeAddr\":\"0x00158d000210d4d2\",\"manufacturerID\":4151,\"manufacturerName\":\"LUMI\",\"model\":\"WXKG01LM\",\"networkAddress\":36077,\"powerSource\":\"Battery\",\"softwareBuildID\":\"3000-0001\",\"stackVersion\":2,\"type\":\"EndDevice\"},\"linkquality\":47,\"power_outage_count\":78,\"voltage\":2982,\"icon\":\"mdi:gesture-double-tap\",\"friendly_name\":\"remote_doorbell_button_action\"},\"last_changed\":\"2023-02-24T23:35:22.159493+00:00\",\"last_updated\":\"2023-02-24T23:35:22.159493+00:00\",\"context\":{\"id\":\"01GT2WFZSFAF0F9EAQK1V5CD7X\",\"parent_id\":null,\"user_id\":null},\"original_state\":\"single\",\"timeSinceChangedMs\":18}}",
        "vt": "json"
      },
      {
        "p": "topic",
        "vt": "str"
      }
    ],
    "repeat": "",
    "crontab": "",
    "once": false,
    "onceDelay": 0.1,
    "topic": "sensor.remote_doorbell_button_action",
    "payload": "{\"id\":\"793e0807-1a43-4934-a9f3-590af05e8c1a\",\"duration\":1.62,\"timestamp\":\"2023-02-24T23:35:23.914Z\",\"attempts\":1,\"camera\":\"manual\",\"zones\":[],\"counts\":{\"person\":1,\"match\":1,\"miss\":0,\"unknown\":0},\"matches\":[{\"name\":\"alicia m\",\"confidence\":99.31,\"match\":true,\"box\":{\"top\":636,\"left\":69,\"width\":561,\"height\":681},\"type\":\"manual\",\"duration\":0.28,\"detector\":\"compreface\",\"filename\":\"972ed9f9-5b5b-4216-959d-2a8b1193b650.jpg\",\"base64\":null}],\"misses\":[],\"unknowns\":[]}",
    "payloadType": "json",
    "x": 1090,
    "y": 600,
    "wires": [
      [
        "9d26e1a43b7468d6"
      ]
    ]
  },
  {
    "id": "757ceece5ae2a82f",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "Turn on Door Rang",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "homeassistant",
    "service": "turn_on",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_boolean.door_rang"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 410,
    "y": 680,
    "wires": [
      [
        "19d4608aca40257c"
      ]
    ]
  },
  {
    "id": "19d4608aca40257c",
    "type": "ha-wait-until",
    "z": "cd7a606d7931c143",
    "name": "Wait for door to lock",
    "server": "7ab5c227.a3ce8c",
    "version": 2,
    "outputs": 2,
    "entityId": "lock.lock_front_door",
    "entityIdFilterType": "exact",
    "property": "state",
    "comparator": "is",
    "value": "locked",
    "valueType": "str",
    "timeout": "3",
    "timeoutType": "num",
    "timeoutUnits": "minutes",
    "checkCurrentState": false,
    "blockInputOverrides": true,
    "outputProperties": [],
    "x": 620,
    "y": 680,
    "wires": [
      [
        "fec1201a9f096ec4"
      ],
      [
        "fec1201a9f096ec4"
      ]
    ]
  },
  {
    "id": "fec1201a9f096ec4",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "Turn off \"Door rang\"",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "homeassistant",
    "service": "turn_off",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_boolean.door_rang"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 840,
    "y": 680,
    "wires": [
      []
    ]
  },
  {
    "id": "9d26e1a43b7468d6",
    "type": "switch",
    "z": "cd7a606d7931c143",
    "name": "Are there matches?",
    "property": "payload.counts.match",
    "propertyType": "msg",
    "rules": [
      {
        "t": "gt",
        "v": "0",
        "vt": "num"
      },
      {
        "t": "eq",
        "v": "0",
        "vt": "num"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 2,
    "x": 1190,
    "y": 720,
    "wires": [
      [
        "d5035d7a4b8abde0",
        "dc5c22f8fb2385a7"
      ],
      [
        "e8ce77d8da41bd8e"
      ]
    ]
  },
  {
    "id": "87766266822443bf",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "Yes",
    "info": "",
    "x": 1890,
    "y": 660,
    "wires": []
  },
  {
    "id": "ca41cbd48ba54a0e",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "No",
    "info": "",
    "x": 1370,
    "y": 740,
    "wires": []
  },
  {
    "id": "8a86d116cbd23a0c",
    "type": "change",
    "z": "cd7a606d7931c143",
    "name": "Set msg.match",
    "rules": [
      {
        "t": "set",
        "p": "match",
        "pt": "msg",
        "to": "payload.matches[0]",
        "tot": "msg",
        "dc": true
      },
      {
        "t": "set",
        "p": "match.camera",
        "pt": "msg",
        "to": "payload.camera",
        "tot": "msg",
        "dc": true
      },
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1520,
    "y": 700,
    "wires": [
      [
        "c4c2d8ee6f80df16"
      ]
    ]
  },
  {
    "id": "7755d95655d67413",
    "type": "http request",
    "z": "cd7a606d7931c143",
    "name": "POST request with Reolink-double-take last image",
    "method": "GET",
    "ret": "obj",
    "paytoqs": "ignore",
    "url": "http://192.168.0.14:3000/api/recognize?url=http://192.168.0.14:3000/api/storage/latest/front_door_camera.jpg&camera=front_door_camera",
    "tls": "",
    "persist": false,
    "proxy": "",
    "insecureHTTPParser": false,
    "authType": "",
    "senderr": false,
    "headers": [],
    "x": 2170,
    "y": 740,
    "wires": [
      [
        "e1b5a65264dfc11d"
      ]
    ]
  },
  {
    "id": "9323da00227c8c8b",
    "type": "inject",
    "z": "cd7a606d7931c143",
    "name": "",
    "props": [
      {
        "p": "payload"
      },
      {
        "p": "topic",
        "vt": "str"
      }
    ],
    "repeat": "",
    "crontab": "",
    "once": false,
    "onceDelay": 0.1,
    "topic": "",
    "payload": "",
    "payloadType": "date",
    "x": 1840,
    "y": 860,
    "wires": [
      [
        "7755d95655d67413"
      ]
    ]
  },
  {
    "id": "e1b5a65264dfc11d",
    "type": "switch",
    "z": "cd7a606d7931c143",
    "name": "Are there matches?",
    "property": "payload.counts.match",
    "propertyType": "msg",
    "rules": [
      {
        "t": "gt",
        "v": "0",
        "vt": "num"
      },
      {
        "t": "eq",
        "v": "0",
        "vt": "num"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 2,
    "x": 2470,
    "y": 740,
    "wires": [
      [
        "f1e47b926b68837c"
      ],
      [
        "0f8df3cecc7769a3"
      ]
    ]
  },
  {
    "id": "b2a4e650595bca7e",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "Yes",
    "info": "",
    "x": 2650,
    "y": 720,
    "wires": []
  },
  {
    "id": "e204bf79e084d730",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "No",
    "info": "",
    "x": 2650,
    "y": 760,
    "wires": []
  },
  {
    "id": "44af510b1d02e54e",
    "type": "inject",
    "z": "cd7a606d7931c143",
    "name": "Maxi at door",
    "props": [
      {
        "p": "payload"
      },
      {
        "p": "data",
        "v": "{\"entity_id\":\"sensor.double_take_front_door\",\"state\":\"3\",\"attributes\":{\"id\":\"1659459685.953183-1shuyf\",\"duration\":3.53,\"timestamp\":\"2022-08-02T17:01:31.497Z\",\"attempts\":11,\"camera\":\"front_door\",\"zones\":[\"entrance\",\"faceshot_zone\"],\"misses\":[{\"name\":\"alphonso\",\"confidence\":79.16,\"match\":false,\"box\":{\"top\":210,\"left\":529,\"width\":85,\"height\":105},\"checks\":[\"box area too low: 8925 < 10000\"],\"type\":\"latest\",\"duration\":0.21,\"detector\":\"deepstack\",\"filename\":\"bcfcd360-f639-45ef-97fa-2f68aa01d8eb.jpg\",\"base64\":null},{\"name\":\"maxi\",\"confidence\":75.7,\"match\":false,\"box\":{\"top\":212,\"left\":354,\"width\":62,\"height\":95},\"checks\":[\"box area too low: 5890 < 10000\"],\"type\":\"latest\",\"duration\":0.19,\"detector\":\"deepstack\",\"filename\":\"49e449d6-65e0-45c6-a21d-237a673b91da.jpg\",\"base64\":null}],\"matches\":[{\"name\":\"maxi\",\"confidence\":72.28,\"match\":true,\"box\":{\"top\":220,\"left\":244,\"width\":102,\"height\":104},\"type\":\"latest\",\"duration\":0.19,\"detector\":\"deepstack\",\"filename\":\"2a731787-cb90-4c90-bbc2-05e910f1576e.jpg\",\"base64\":null},{\"name\":\"nate\",\"confidence\":72.15,\"match\":true,\"box\":{\"top\":228,\"left\":203,\"width\":106,\"height\":98},\"type\":\"snapshot\",\"duration\":0.2,\"detector\":\"deepstack\",\"filename\":\"b5678550-20b0-4b04-a1b5-db4297d7a7ed.jpg\",\"base64\":null}],\"personCount\":3,\"icon\":\"mdi:camera\",\"friendly_name\":\"double_take_front_door\"},\"last_changed\":\"2022-08-02T17:01:31.518682+00:00\",\"last_updated\":\"2022-08-02T17:01:31.518682+00:00\",\"context\":{\"id\":\"01G9FR2RZYY9SBNXVSHJ5T9E0S\",\"parent_id\":null,\"user_id\":null},\"timeSinceChangedMs\":1499,\"original_state\":\"3\"}",
        "vt": "json"
      },
      {
        "p": "topic",
        "vt": "str"
      }
    ],
    "repeat": "",
    "crontab": "",
    "once": false,
    "onceDelay": 0.1,
    "topic": "sensor.remote_doorbell_button_action",
    "payload": "3",
    "payloadType": "num",
    "x": 2830,
    "y": 860,
    "wires": [
      [
        "fdc333b7d683f18c"
      ]
    ]
  },
  {
    "id": "b2c03746e03a6726",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "JavascriptNotification setter Reolink",
    "func": "var name = \"Someone\";\nvar url1 = \"https://hass.purgatoire.ca/local/reolinkring.jpg\";\nvar url2 = \"https://hass.purgatoire.ca/local/ring.jpg\";\nvar random = Date.now();\n\nvar newMsg = {\n\t\"payload\": {\n\t\t\"data\": {\n\t\t\t\"message\": \"Doorbell Alert\",\n\t\t\t\"title\": name + \" is at the door\",\n\t\t\t\"data\": {\n\t\t\t\t\"sticky\": 'true',\n\t\t\t\t\"clickAction\": '/phone-landing/reolink?kiosk=1',\n\t\t\t\t\"priority\": 'high',\n\t\t\t\t\"image\": url1 + \"?\" + random,\n\t\t\t\t\"actions\": [{\n\t\t\t\t\t\t\"action\": \"REPLY\",\n\t\t\t\t\t\t\"title\": \"Enter Text\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"action\": \"unlock_door\",\n\t\t\t\t\t\t\"title\": \"Unlock The Door\"\n\t\t\t\t\t}\n\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t}\n};\nreturn newMsg;",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 4260,
    "y": 800,
    "wires": [
      [
        "1a15e85a29c4f2bf",
        "75f2fce62b13cbe7"
      ]
    ]
  },
  {
    "id": "759704f763b58501",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "Save Reolink.jpg for notif",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "camera",
    "service": "snapshot",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "camera.front_door_go2rtc"
    ],
    "data": "{\"filename\":\"/config/www/reolinkring.jpg\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 3970,
    "y": 760,
    "wires": [
      [
        "b2c03746e03a6726",
        "4d080cad7eb6e607"
      ]
    ]
  },
  {
    "id": "4d080cad7eb6e607",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "Notification setter Facecam",
    "func": "var name = \"Someone\";\nvar url1 = \"https://hass.purgatoire.ca/local/reolinkring.jpg\";\nvar url2 = \"https://hass.purgatoire.ca/local/ring.jpg\";\nvar random = Date.now();\n\nvar newMsg = {\n\t\"payload\": {\n\t\t\"data\": {\n\t\t\t\"message\": \"Doorbell Alert\",\n\t\t\t\"title\": name + \" is at the door\",\n\t\t\t\"data\": {\n\t\t\t\t\"sticky\": 'true',\n\t\t\t\t\"clickAction\": '/phone-landing/reolink?kiosk=1',\n\t\t\t\t\"priority\": 'high',\n\t\t\t\t\"image\": url2 + \"?\" + random,\n\t\t\t\t\"actions\": [{\n\t\t\t\t\t\"action\": \"REPLY\",\n\t\t\t\t\t\"title\": \"Who is this?\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"action\": \"unlock_door\",\n\t\t\t\t\t\"title\": \"Unlock The Door\"\n\t\t\t\t}\n\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t}\n};\nreturn newMsg;",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 4260,
    "y": 840,
    "wires": [
      [
        "75f2fce62b13cbe7"
      ]
    ]
  },
  {
    "id": "7b4039020f84dc97",
    "type": "inject",
    "z": "cd7a606d7931c143",
    "name": "",
    "props": [
      {
        "p": "payload"
      },
      {
        "p": "topic",
        "vt": "str"
      }
    ],
    "repeat": "",
    "crontab": "",
    "once": false,
    "onceDelay": 0.1,
    "topic": "",
    "payload": "",
    "payloadType": "date",
    "x": 200,
    "y": 640,
    "wires": [
      [
        "ce230f98044f9ce1"
      ]
    ]
  },
  {
    "id": "dc5c22f8fb2385a7",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "debug 199",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 1410,
    "y": 480,
    "wires": []
  },
  {
    "id": "c4c2d8ee6f80df16",
    "type": "switch",
    "z": "cd7a606d7931c143",
    "name": "confidence over 80%?",
    "property": "match.confidence",
    "propertyType": "msg",
    "rules": [
      {
        "t": "gt",
        "v": "80",
        "vt": "num"
      },
      {
        "t": "lt",
        "v": "80",
        "vt": "num"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 2,
    "x": 1720,
    "y": 700,
    "wires": [
      [
        "79ea6e5eebeb3dc4"
      ],
      [
        "1d8a1bf5c390d165"
      ]
    ]
  },
  {
    "id": "eff0a4e4802948b8",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "No",
    "info": "",
    "x": 1890,
    "y": 740,
    "wires": []
  },
  {
    "id": "84662acf4451979c",
    "type": "change",
    "z": "cd7a606d7931c143",
    "name": "Set msg.match",
    "rules": [
      {
        "t": "set",
        "p": "match",
        "pt": "msg",
        "to": "payload.matches[0]",
        "tot": "msg",
        "dc": true
      },
      {
        "t": "set",
        "p": "match.camera",
        "pt": "msg",
        "to": "payload.camera",
        "tot": "msg",
        "dc": true
      },
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 2800,
    "y": 720,
    "wires": [
      [
        "52ab15905efdccbf"
      ]
    ]
  },
  {
    "id": "52ab15905efdccbf",
    "type": "switch",
    "z": "cd7a606d7931c143",
    "name": "confidence over 80%?",
    "property": "match.confidence",
    "propertyType": "msg",
    "rules": [
      {
        "t": "gt",
        "v": "80",
        "vt": "num"
      },
      {
        "t": "lt",
        "v": "80",
        "vt": "num"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 2,
    "x": 3000,
    "y": 720,
    "wires": [
      [
        "94e15e45a5dd4895"
      ],
      [
        "13611f4c75079d74"
      ]
    ]
  },
  {
    "id": "93d6cda3f0e6e049",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "Yes",
    "info": "",
    "x": 3190,
    "y": 700,
    "wires": []
  },
  {
    "id": "bb918eb43d688bdd",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "No",
    "info": "",
    "x": 3190,
    "y": 740,
    "wires": []
  },
  {
    "id": "1a15e85a29c4f2bf",
    "type": "change",
    "z": "cd7a606d7931c143",
    "name": "Set Data for mass alert",
    "rules": [
      {
        "t": "move",
        "p": "payload.data.title",
        "pt": "msg",
        "to": "message",
        "tot": "msg"
      },
      {
        "t": "set",
        "p": "color_value",
        "pt": "msg",
        "to": "[0,0,255]",
        "tot": "json"
      },
      {
        "t": "set",
        "p": "dbrigthness",
        "pt": "msg",
        "to": "100",
        "tot": "num"
      },
      {
        "t": "set",
        "p": "video",
        "pt": "msg",
        "to": "on",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 4540,
    "y": 760,
    "wires": [
      [
        "869011ab1d65be1d"
      ]
    ]
  },
  {
    "id": "869011ab1d65be1d",
    "type": "subflow:233ac7dcd801a802",
    "z": "cd7a606d7931c143",
    "name": "",
    "x": 4770,
    "y": 760,
    "wires": []
  },
  {
    "id": "1802a44a8c51174f",
    "type": "api-current-state",
    "z": "cd7a606d7931c143",
    "name": "Acid time off",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "off",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "input_boolean.acid_time",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 3550,
    "y": 660,
    "wires": [
      [
        "ed706878831ed655"
      ],
      [
        "78575bad96d21598"
      ]
    ]
  },
  {
    "id": "ed706878831ed655",
    "type": "api-current-state",
    "z": "cd7a606d7931c143",
    "name": "kink off",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "off",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "input_boolean.kink_party",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "override_topic": false,
    "state_location": "payload",
    "override_payload": "msg",
    "entity_location": "data",
    "override_data": "msg",
    "x": 3720,
    "y": 660,
    "wires": [
      [
        "5b7f84552314f7fb",
        "f152504f7838b65f"
      ],
      [
        "f9d1114c3060999d"
      ]
    ]
  },
  {
    "id": "8f42a1e376b2f151",
    "type": "api-current-state",
    "z": "cd7a606d7931c143",
    "name": "Waiting Friend?",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "on",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "input_boolean.waiting_someone",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [
      {
        "property": "partyon",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      },
      {
        "property": "partydata",
        "propertyType": "msg",
        "value": "",
        "valueType": "entity"
      }
    ],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 3980,
    "y": 700,
    "wires": [
      [
        "622b280fd9e0e6f8"
      ],
      [
        "e6e258ae376ae884"
      ]
    ]
  },
  {
    "id": "5b7f84552314f7fb",
    "type": "api-current-state",
    "z": "cd7a606d7931c143",
    "name": "Party on",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "on",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "input_boolean.party_mode",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "override_topic": false,
    "state_location": "payload",
    "override_payload": "msg",
    "entity_location": "data",
    "override_data": "msg",
    "x": 3880,
    "y": 620,
    "wires": [
      [
        "eca51006f7ccf6da"
      ],
      [
        "8f42a1e376b2f151"
      ]
    ]
  },
  {
    "id": "116f7fc3f104a266",
    "type": "api-current-state",
    "z": "cd7a606d7931c143",
    "name": "Waiting Uber off",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "off",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "input_boolean.waiting_uber",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 3360,
    "y": 660,
    "wires": [
      [
        "1802a44a8c51174f"
      ],
      [
        "625b7fb50bb7a849"
      ]
    ]
  },
  {
    "id": "a74c2ad35eac8a53",
    "type": "api-current-state",
    "z": "cd7a606d7931c143",
    "name": "Front House Motion",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "on",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "binary_sensor.motion_front",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [
      {
        "property": "partyon",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      },
      {
        "property": "partydata",
        "propertyType": "msg",
        "value": "",
        "valueType": "entity"
      }
    ],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 4250,
    "y": 660,
    "wires": [
      [
        "36c151f20a99b664",
        "491b918fb32cff35"
      ],
      [
        "e6e258ae376ae884"
      ]
    ]
  },
  {
    "id": "037893fa810691e1",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "debug 200",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 4790,
    "y": 620,
    "wires": []
  },
  {
    "id": "5b6f95c2a8b5d696",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "No",
    "info": "",
    "x": 3370,
    "y": 740,
    "wires": []
  },
  {
    "id": "8991ba94f70551a7",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "No",
    "info": "",
    "x": 3550,
    "y": 740,
    "wires": []
  },
  {
    "id": "f630f901bd03402a",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "No",
    "info": "",
    "x": 3730,
    "y": 740,
    "wires": []
  },
  {
    "id": "3286fb8b0a7a7ed7",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "No",
    "info": "",
    "x": 4130,
    "y": 700,
    "wires": []
  },
  {
    "id": "36c151f20a99b664",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "Notif setter",
    "func": "var name = msg.match.name\nvar url1 = \"https://hass.purgatoire.ca/local/reolinkring.jpg\";\nvar url2 = \"https://hass.purgatoire.ca/local/ring.jpg\";\nvar random = Date.now();\nvar cameraused = msg.match.camera;\n\nif (cameraused == \"faceshot_camera\") {\n\tvar usedurl = url2;\n}\nif (cameraused == \"front_door_camera\") {\n\tvar usedurl = url1;\n}\n\n\n\n\nvar newMsg = {\n\t\"payload\": {\n\t\t\"data\": {\n\t\t\t\"message\": \"Guest Alert\",\n\t\t\t\"title\": name + \" is being let in\",\n\t\t\t\"data\": {\n\t\t\t\t\"sticky\": 'true',\n\t\t\t\t\"clickAction\": '/phone-landing/reolink?kiosk=1',\n\t\t\t\t\"priority\": 'high',\n\t\t\t\t\"image\": usedurl + \"?\" + random,\n\t\t\t\t\"actions\": [{\n\t\t\t\t\t\"action\": \"REPLY\",\n\t\t\t\t\t\"title\": \"Enter Text\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"action\": \"unlock_door\",\n\t\t\t\t\t\"title\": \"Unlock The Door\"\n\t\t\t\t}\n\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t}\n};\nreturn newMsg;",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 4470,
    "y": 680,
    "wires": [
      [
        "037893fa810691e1",
        "37d31009dd04fd36",
        "6344ca923892ef31"
      ]
    ]
  },
  {
    "id": "37d31009dd04fd36",
    "type": "change",
    "z": "cd7a606d7931c143",
    "name": "Set Data for mass alert",
    "rules": [
      {
        "t": "move",
        "p": "payload.data.title",
        "pt": "msg",
        "to": "message",
        "tot": "msg"
      },
      {
        "t": "set",
        "p": "color_value",
        "pt": "msg",
        "to": "[200,200.0]",
        "tot": "json"
      },
      {
        "t": "set",
        "p": "dbrigthness",
        "pt": "msg",
        "to": "100",
        "tot": "num"
      },
      {
        "t": "set",
        "p": "video",
        "pt": "msg",
        "to": "on",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 4540,
    "y": 720,
    "wires": [
      [
        "869011ab1d65be1d"
      ]
    ]
  },
  {
    "id": "9be2f214cabf3c56",
    "type": "delay",
    "z": "cd7a606d7931c143",
    "name": "1M/S",
    "pauseType": "queue",
    "timeout": "5",
    "timeoutUnits": "seconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "second",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": true,
    "allowrate": false,
    "outputs": 1,
    "x": 4070,
    "y": 640,
    "wires": [
      [
        "a74c2ad35eac8a53"
      ]
    ]
  },
  {
    "id": "0751b4256605b31e",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "unLock Door",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "lock",
    "service": "unlock",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "lock.lock_front_door"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 4010,
    "y": 520,
    "wires": [
      [
        "a6c151d464d2a7bb",
        "4b3622c38c8a3d4c"
      ]
    ]
  },
  {
    "id": "a6c151d464d2a7bb",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "unlock",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 4150,
    "y": 480,
    "wires": []
  },
  {
    "id": "4b3622c38c8a3d4c",
    "type": "ha-wait-until",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 2,
    "outputs": 2,
    "entityId": "lock.lock_front_door",
    "entityIdFilterType": "exact",
    "property": "state",
    "comparator": "is",
    "value": "unlocked",
    "valueType": "str",
    "timeout": "2",
    "timeoutType": "num",
    "timeoutUnits": "minutes",
    "checkCurrentState": true,
    "blockInputOverrides": true,
    "outputProperties": [],
    "x": 4160,
    "y": 520,
    "wires": [
      [
        "3929f62648b94b4f"
      ],
      []
    ]
  },
  {
    "id": "7329f3a0fc96f8f5",
    "type": "ha-wait-until",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 2,
    "outputs": 2,
    "entityId": "lock.lock_front_door",
    "entityIdFilterType": "exact",
    "property": "state",
    "comparator": "is",
    "value": "locked",
    "valueType": "str",
    "timeout": "30",
    "timeoutType": "num",
    "timeoutUnits": "seconds",
    "checkCurrentState": true,
    "blockInputOverrides": true,
    "outputProperties": [],
    "x": 4500,
    "y": 520,
    "wires": [
      [
        "78e6c9cc2f3f3221"
      ],
      [
        "78e6c9cc2f3f3221"
      ]
    ]
  },
  {
    "id": "78e6c9cc2f3f3221",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "toggle boolean",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "homeassistant",
    "service": "turn_off",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_boolean.face_recognized",
      "input_boolean.waiting_someone"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 4680,
    "y": 520,
    "wires": [
      [
        "578b9966eaf564a5"
      ]
    ]
  },
  {
    "id": "578b9966eaf564a5",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "input_text",
    "service": "set_value",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_text.recognized_face"
    ],
    "data": " {             \"value\": \"UNKNOWN\"         }",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 4890,
    "y": 520,
    "wires": [
      []
    ]
  },
  {
    "id": "491b918fb32cff35",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "Name Payload",
    "func": "var name = msg.match.name;\n\nvar newMsg = {\n    \"payload\": {\n        \"data\": {\n            \"value\": name\n        }}};\nreturn newMsg;\n",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 4360,
    "y": 580,
    "wires": [
      [
        "ec5c61fd69030e8e"
      ]
    ]
  },
  {
    "id": "ec5c61fd69030e8e",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "input_text",
    "service": "set_value",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_text.recognized_face"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 4560,
    "y": 580,
    "wires": [
      [
        "ceaf2b9901f10668"
      ]
    ]
  },
  {
    "id": "3929f62648b94b4f",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "toggle boolean",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "homeassistant",
    "service": "turn_on",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_boolean.face_recognized"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 4320,
    "y": 520,
    "wires": [
      [
        "7329f3a0fc96f8f5"
      ]
    ]
  },
  {
    "id": "ceaf2b9901f10668",
    "type": "trigger",
    "z": "cd7a606d7931c143",
    "name": "",
    "op1": "1",
    "op2": "",
    "op1type": "str",
    "op2type": "nul",
    "duration": "250",
    "extend": false,
    "overrideDelay": false,
    "units": "ms",
    "reset": "",
    "bytopic": "all",
    "topic": "topic",
    "outputs": 1,
    "x": 4080,
    "y": 580,
    "wires": [
      [
        "0751b4256605b31e"
      ]
    ]
  },
  {
    "id": "a03781b4d453187a",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "Save Facecam Ring.jpg For Debug",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "camera",
    "service": "snapshot",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "camera.faceshot_go2rtc"
    ],
    "data": "{\"filename\":\"/config/www/ring.jpg\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 520,
    "y": 180,
    "wires": [
      []
    ]
  },
  {
    "id": "14716af57c8f9b9d",
    "type": "inject",
    "z": "cd7a606d7931c143",
    "name": "",
    "props": [
      {
        "p": "payload"
      },
      {
        "p": "topic",
        "vt": "str"
      }
    ],
    "repeat": "",
    "crontab": "",
    "once": false,
    "onceDelay": 0.1,
    "topic": "",
    "payload": "",
    "payloadType": "date",
    "x": 300,
    "y": 160,
    "wires": [
      [
        "a03781b4d453187a"
      ]
    ]
  },
  {
    "id": "6b34a4c899761c04",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "Save Reolink.jpg for notif",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "camera",
    "service": "snapshot",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "camera.front_door_go2rtc"
    ],
    "data": "{\"filename\":\"/config/www/reolinkring.jpg\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 1730,
    "y": 220,
    "wires": [
      []
    ]
  },
  {
    "id": "8a39449972026570",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "Save Facecam Ring.jpg For Debug",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "camera",
    "service": "snapshot",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "camera.faceshot_go2rtc"
    ],
    "data": "{\"filename\":\"/config/www/ring.jpg\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 1400,
    "y": 220,
    "wires": [
      [
        "6b34a4c899761c04"
      ]
    ]
  },
  {
    "id": "31c62afa4e6e505f",
    "type": "inject",
    "z": "cd7a606d7931c143",
    "name": "",
    "props": [
      {
        "p": "payload"
      },
      {
        "p": "topic",
        "vt": "str"
      }
    ],
    "repeat": "",
    "crontab": "",
    "once": false,
    "onceDelay": 0.1,
    "topic": "",
    "payload": "",
    "payloadType": "date",
    "x": 1160,
    "y": 220,
    "wires": [
      [
        "8a39449972026570"
      ]
    ]
  },
  {
    "id": "6b66e722564ac9a3",
    "type": "exec",
    "z": "cd7a606d7931c143",
    "command": "rm /config/www/ring.jpg",
    "addpay": "",
    "append": "",
    "useSpawn": "false",
    "timer": "",
    "winHide": false,
    "oldrc": false,
    "name": "",
    "x": 1410,
    "y": 100,
    "wires": [
      [
        "aa50610b81b16971"
      ],
      [
        "aa50610b81b16971"
      ],
      [
        "aa50610b81b16971"
      ]
    ]
  },
  {
    "id": "aa50610b81b16971",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "debug 201",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 2070,
    "y": 140,
    "wires": []
  },
  {
    "id": "53b3851fe8d777e6",
    "type": "inject",
    "z": "cd7a606d7931c143",
    "name": "",
    "props": [
      {
        "p": "payload"
      },
      {
        "p": "topic",
        "vt": "str"
      }
    ],
    "repeat": "",
    "crontab": "",
    "once": false,
    "onceDelay": 0.1,
    "topic": "",
    "payload": "",
    "payloadType": "date",
    "x": 1194.8958129882812,
    "y": 100,
    "wires": [
      [
        "6b66e722564ac9a3"
      ]
    ]
  },
  {
    "id": "5197a8dcb4f7e262",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "Save Facecam Ring.jpg For Notification",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "camera",
    "service": "snapshot",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "camera.faceshot_go2rtc"
    ],
    "data": "{\"filename\":\"/config/www/ring.jpg\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 480,
    "y": 760,
    "wires": [
      []
    ]
  },
  {
    "id": "df92c7792f1fbbd4",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "No",
    "info": "",
    "x": 3890,
    "y": 660,
    "wires": []
  },
  {
    "id": "6344ca923892ef31",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "notify",
    "service": "mobile_app_phone_fold4",
    "areaId": [],
    "deviceId": [],
    "entityId": [],
    "data": "{\"message\":\"Bedroom door open\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 4810,
    "y": 680,
    "wires": [
      []
    ]
  },
  {
    "id": "75f2fce62b13cbe7",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "notify",
    "service": "mobile_app_phone_fold4",
    "areaId": [],
    "deviceId": [],
    "entityId": [],
    "data": "{\"message\":\"Bedroom door open\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 4570,
    "y": 840,
    "wires": [
      []
    ]
  },
  {
    "id": "315f5569a3cd1e1f",
    "type": "switch",
    "z": "cd7a606d7931c143",
    "name": "'Who is this?'?",
    "property": "payload.event.action_1_title",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "Who is this?",
        "vt": "str"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 1,
    "x": 1150,
    "y": 2660,
    "wires": [
      [
        "c2662100f7dada1b"
      ]
    ]
  },
  {
    "id": "66870ae54d415f31",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "Javascript",
    "func": "var name = msg.data.event.reply_text;\n\nvar newMsg = {\n \"url\": \"http://192.168.0.14:3000/api/train/retrain/\" + name,\n \"data\": msg.data\n };\n\nreturn newMsg;",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 1840,
    "y": 2700,
    "wires": [
      [
        "c8a2221e9878688b",
        "59387ed647db9b45"
      ]
    ]
  },
  {
    "id": "abb2babfbaf1f043",
    "type": "server-events",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 2,
    "eventType": "mobile_app_notification_action",
    "eventData": "",
    "waitForRunning": true,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "eventData"
      },
      {
        "property": "topic",
        "propertyType": "msg",
        "value": "$outputData(\"eventData\").event_type",
        "valueType": "jsonata"
      },
      {
        "property": "event_type",
        "propertyType": "msg",
        "value": "$outputData(\"eventData\").event_type",
        "valueType": "jsonata"
      }
    ],
    "exposeToHomeAssistant": false,
    "haConfig": [
      {
        "property": "name",
        "value": ""
      },
      {
        "property": "icon",
        "value": ""
      }
    ],
    "x": 900,
    "y": 2700,
    "wires": [
      [
        "df207d122707860f",
        "315f5569a3cd1e1f"
      ]
    ]
  },
  {
    "id": "59387ed647db9b45",
    "type": "http request",
    "z": "cd7a606d7931c143",
    "name": "POST request",
    "method": "GET",
    "ret": "txt",
    "paytoqs": "ignore",
    "url": "",
    "tls": "",
    "persist": false,
    "proxy": "",
    "insecureHTTPParser": false,
    "authType": "",
    "senderr": false,
    "headers": [],
    "x": 2040,
    "y": 2700,
    "wires": [
      [
        "1f14ea34c73aed0f",
        "19d14fb87189e552"
      ]
    ]
  },
  {
    "id": "df207d122707860f",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "actionable",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 1250,
    "y": 2760,
    "wires": []
  },
  {
    "id": "19d14fb87189e552",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "Javascript",
    "func": "var snapshot = msg.data.event.image;\nvar name = msg.data.event.reply_text;\nvar newMsg = {\n \"payload\": {\n  \"data\": {\n  \"message\": \"Faces learning for\" + \" \" + name,\n  \"data\": {\n    \"image\": snapshot\n  }\n}\n }\n};\nreturn newMsg;\n",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 2680,
    "y": 2700,
    "wires": [
      [
        "f0ec948dd57314cf",
        "1832a1b9f4db63f9"
      ]
    ]
  },
  {
    "id": "f0ec948dd57314cf",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "notify",
    "service": "notify",
    "areaId": [],
    "deviceId": [],
    "entityId": [],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 2880,
    "y": 2700,
    "wires": [
      [
        "19661f924505b1f0"
      ]
    ]
  },
  {
    "id": "19661f924505b1f0",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 2870,
    "y": 2640,
    "wires": []
  },
  {
    "id": "b20fb29fbb0e92c3",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "Javascript",
    "func": "var d = new Date();\nvar name = msg.payload.name;\nvar m = d.getMilliseconds();\nvar snapshot = msg.payload.data.filename;\nvar url = \"http://192.168.0.12:8765/picture/8/current/?\" + m;\n\nvar snapshot = snapshot.replace(\"\\/config\\/www\",\"https:\\/\\/hass.purgatoire.ca\\/local\");\n\n\nvar newMsg = {\n\t\"payload\": {\n\t\t\"data\": {\n\t\t\t\"message\": \"Doorbell Alert\",\n\t\t\t\"title\": name + \" is at the door\",\n\t\t\t\"data\": {\n\t\t\t\t\"image\": snapshot,\n\t\t\t\t\"actions\": [{\n\t\t\t\t\t\t\"action\": \"REPLY\",\n\t\t\t\t\t\t\"title\": \"Who is this?\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"action\": \"unlock_door\",\n\t\t\t\t\t\t\"title\": \"Unlock The Door\"\n\t\t\t\t\t}\n\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t}\n};\nreturn newMsg;",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 3780,
    "y": 960,
    "wires": [
      []
    ]
  },
  {
    "id": "b25e207878661b2c",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "Notification setter Facecam",
    "func": "var name = \"Someone\";\nvar url1 = \"https://hass.purgatoire.ca/local/reolinkring.jpg\";\nvar url2 = \"https://hass.purgatoire.ca/local/ring.jpg\";\nvar random = Date.now();\n\nvar newMsg = {\n\t\"payload\": {\n\t\t\"data\": {\n\t\t\t\"message\": \"Doorbell Alert\",\n\t\t\t\"title\": name + \" is at the door\",\n\t\t\t\"data\": {\n\t\t\t\t\"sticky\": 'true',\n\t\t\t\t\"clickAction\": '/phone-landing/reolink?kiosk=1',\n\t\t\t\t\"priority\": 'high',\n\t\t\t\t\"image\": url2 + \"?\" + random,\n\t\t\t\t\"actions\": [{\n\t\t\t\t\t\"action\": \"unlock_door\",\n\t\t\t\t\t\"title\": \"Unlock The Door!\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"action\": \"REPLY\",\n\t\t\t\t\t\"title\": \"Who is this?\"\n\t\t\t\t}\n\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t}\n};\nreturn newMsg;",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 680,
    "y": 1940,
    "wires": [
      [
        "222adf3ff52bb56b"
      ]
    ]
  },
  {
    "id": "222adf3ff52bb56b",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "notify",
    "service": "mobile_app_phone_fold4",
    "areaId": [],
    "deviceId": [],
    "entityId": [],
    "data": "{\"message\":\"Bedroom door open\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 990,
    "y": 1940,
    "wires": [
      []
    ]
  },
  {
    "id": "cdd8368d7ec62007",
    "type": "inject",
    "z": "cd7a606d7931c143",
    "name": "",
    "props": [
      {
        "p": "payload"
      },
      {
        "p": "topic",
        "vt": "str"
      }
    ],
    "repeat": "",
    "crontab": "",
    "once": false,
    "onceDelay": 0.1,
    "topic": "",
    "payload": "",
    "payloadType": "date",
    "x": 460,
    "y": 1940,
    "wires": [
      [
        "b25e207878661b2c"
      ]
    ]
  },
  {
    "id": "c2662100f7dada1b",
    "type": "switch",
    "z": "cd7a606d7931c143",
    "name": "",
    "property": "payload.event.action",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "REPLY",
        "vt": "str"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 1,
    "x": 1300,
    "y": 2700,
    "wires": [
      [
        "3342da11fe49855e"
      ]
    ]
  },
  {
    "id": "7ca9b3d1c4953a79",
    "type": "server-events",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 2,
    "eventType": "mobile_app_notification_action",
    "eventData": "",
    "waitForRunning": true,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "eventData"
      },
      {
        "property": "topic",
        "propertyType": "msg",
        "value": "$outputData(\"eventData\").event_type",
        "valueType": "jsonata"
      },
      {
        "property": "event_type",
        "propertyType": "msg",
        "value": "$outputData(\"eventData\").event_type",
        "valueType": "jsonata"
      }
    ],
    "exposeToHomeAssistant": false,
    "haConfig": [
      {
        "property": "name",
        "value": ""
      },
      {
        "property": "icon",
        "value": ""
      }
    ],
    "x": 290,
    "y": 1240,
    "wires": [
      [
        "fc2028b5a047d6c0"
      ]
    ]
  },
  {
    "id": "fc2028b5a047d6c0",
    "type": "switch",
    "z": "cd7a606d7931c143",
    "name": "",
    "property": "payload.event.action_1_title",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "Enter Text",
        "vt": "str"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 1,
    "x": 550,
    "y": 1240,
    "wires": [
      [
        "2a770d5c5b0126d9"
      ]
    ]
  },
  {
    "id": "d377f9603c40973f",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "Javascript",
    "func": "var text = msg.payload.event.reply_text;\n\n\n\nvar newMsg = {\n    \"text\": msg.payload.event.image,\n    \"payload\": {\n        \"data\": {\n            \"value\": text\n        }\n    }\n};\nreturn newMsg;",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 820,
    "y": 1240,
    "wires": [
      [
        "9f3f959c6b7cf905"
      ]
    ]
  },
  {
    "id": "9f3f959c6b7cf905",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "input_text",
    "service": "set_value",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_text.front_door_phone_text"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 1020,
    "y": 1240,
    "wires": [
      [
        "035ecb8b05a7849e"
      ]
    ]
  },
  {
    "id": "92e9992baaede561",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "input_text",
    "service": "set_value",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_text.front_door_phone_text"
    ],
    "data": "{\"value\":\"Empty\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 1500,
    "y": 1240,
    "wires": [
      []
    ]
  },
  {
    "id": "2a770d5c5b0126d9",
    "type": "switch",
    "z": "cd7a606d7931c143",
    "name": "",
    "property": "payload.event.action",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "REPLY",
        "vt": "str"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 1,
    "x": 690,
    "y": 1240,
    "wires": [
      [
        "d377f9603c40973f"
      ]
    ]
  },
  {
    "id": "035ecb8b05a7849e",
    "type": "ha-wait-until",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 2,
    "outputs": 2,
    "entityId": "lock.lock_front_door",
    "entityIdFilterType": "exact",
    "property": "state",
    "comparator": "is",
    "value": "locked",
    "valueType": "str",
    "timeout": "120",
    "timeoutType": "num",
    "timeoutUnits": "seconds",
    "checkCurrentState": false,
    "blockInputOverrides": true,
    "outputProperties": [],
    "entityLocation": "data",
    "entityLocationType": "none",
    "x": 1240,
    "y": 1240,
    "wires": [
      [
        "92e9992baaede561"
      ],
      [
        "92e9992baaede561"
      ]
    ]
  },
  {
    "id": "3654de3dfbdb6a8c",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "debug 202",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 890,
    "y": 780,
    "wires": []
  },
  {
    "id": "9dfcedb9cabbcf13",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "Save Facecam Ring.jpg For Notification",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "camera",
    "service": "snapshot",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "camera.faceshot_go2rtc"
    ],
    "data": "{\"filename\":\"/config/www/ring.jpg\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 1000,
    "y": 760,
    "wires": [
      []
    ]
  },
  {
    "id": "2c76e0fbbabb090c",
    "type": "inject",
    "z": "cd7a606d7931c143",
    "name": "",
    "props": [
      {
        "p": "payload"
      },
      {
        "p": "topic",
        "vt": "str"
      }
    ],
    "repeat": "",
    "crontab": "",
    "once": false,
    "onceDelay": 0.1,
    "topic": "",
    "payload": "",
    "payloadType": "date",
    "x": 560,
    "y": 3100,
    "wires": [
      [
        "8e6d0b4579baf31a"
      ]
    ]
  },
  {
    "id": "6a37007e21a4e0d1",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "Turn on Door Rang",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "homeassistant",
    "service": "turn_on",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_boolean.door_rang"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 330,
    "y": 3020,
    "wires": [
      [
        "71e0d748146f24f3"
      ]
    ]
  },
  {
    "id": "71e0d748146f24f3",
    "type": "ha-wait-until",
    "z": "cd7a606d7931c143",
    "name": "Wait for door to lock",
    "server": "7ab5c227.a3ce8c",
    "version": 2,
    "outputs": 2,
    "entityId": "lock.lock_front_door",
    "entityIdFilterType": "exact",
    "property": "state",
    "comparator": "is",
    "value": "locked",
    "valueType": "str",
    "timeout": "3",
    "timeoutType": "num",
    "timeoutUnits": "minutes",
    "checkCurrentState": false,
    "blockInputOverrides": true,
    "outputProperties": [],
    "x": 540,
    "y": 3020,
    "wires": [
      [
        "84c613ebdb9f54ce"
      ],
      [
        "84c613ebdb9f54ce"
      ]
    ]
  },
  {
    "id": "f8cff82299310dbf",
    "type": "switch",
    "z": "cd7a606d7931c143",
    "name": "Are there matches?",
    "property": "payload.counts.match",
    "propertyType": "msg",
    "rules": [
      {
        "t": "gt",
        "v": "0",
        "vt": "num"
      },
      {
        "t": "eq",
        "v": "0",
        "vt": "num"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 2,
    "x": 1590,
    "y": 3180,
    "wires": [
      [
        "56d369d20406df30"
      ],
      [
        "e9d9c66b8213d739"
      ]
    ]
  },
  {
    "id": "84c613ebdb9f54ce",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "Turn off \"Door rang\"",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "homeassistant",
    "service": "turn_off",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_boolean.door_rang"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 760,
    "y": 3020,
    "wires": [
      []
    ]
  },
  {
    "id": "923786bcd627d0aa",
    "type": "change",
    "z": "cd7a606d7931c143",
    "name": "Set msg.match",
    "rules": [
      {
        "t": "set",
        "p": "match",
        "pt": "msg",
        "to": "payload.matches[0]",
        "tot": "msg",
        "dc": true
      },
      {
        "t": "set",
        "p": "match.camera",
        "pt": "msg",
        "to": "payload.camera",
        "tot": "msg",
        "dc": true
      },
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1780,
    "y": 3120,
    "wires": [
      [
        "d423506baddd2bd9"
      ]
    ]
  },
  {
    "id": "be28788662f968dd",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "No",
    "info": "",
    "x": 1790,
    "y": 3200,
    "wires": []
  },
  {
    "id": "4d0f23156408d18c",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "Save Facecam Ring.jpg For Notification",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "camera",
    "service": "snapshot",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "camera.faceshot_go2rtc"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 560,
    "y": 3180,
    "wires": [
      [
        "9bdbe4a072ec21c8",
        "6fbc1313b7294867"
      ]
    ]
  },
  {
    "id": "8e6d0b4579baf31a",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "Name Payload",
    "func": "var random = Date.now();\n\nvar newMsg = {\n    \"payload\": {\n        \"data\": { \"filename\": \"/config/www/\" + random + \".jpg\" }}};\nreturn newMsg;\n",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 300,
    "y": 3180,
    "wires": [
      [
        "4d0f23156408d18c"
      ]
    ]
  },
  {
    "id": "9bdbe4a072ec21c8",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "Convert path to http path",
    "func": "var path = msg.payload.data.filename;\nvar http_path = path.replace('/config/www/', 'http://192.168.0.14:3000/api/recognize?url=http://192.168.0.15:8123/local/');\n\nvar newMsg = { \n          \"url\": http_path\n        \n};\nreturn newMsg;\n\n",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 870,
    "y": 3180,
    "wires": [
      [
        "71efb06c3d520ee0",
        "daceeb7f34803375"
      ]
    ]
  },
  {
    "id": "71efb06c3d520ee0",
    "type": "http request",
    "z": "cd7a606d7931c143",
    "name": "POST request with link to current image on faceshot camera",
    "method": "GET",
    "ret": "obj",
    "paytoqs": "query",
    "url": "",
    "tls": "",
    "persist": false,
    "proxy": "",
    "insecureHTTPParser": false,
    "authType": "",
    "senderr": false,
    "headers": [],
    "x": 1220,
    "y": 3180,
    "wires": [
      [
        "f8cff82299310dbf",
        "b6978e3cb658ead3"
      ]
    ]
  },
  {
    "id": "daceeb7f34803375",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "debug 249",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 1071.111083984375,
    "y": 3273.333251953125,
    "wires": []
  },
  {
    "id": "a1af7a8ad1fdea77",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "debug 250",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 2350,
    "y": 3040,
    "wires": []
  },
  {
    "id": "d221db1c2369290c",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "JavascriptNotification setter Reolink",
    "func": "var name = \"Someone\";\nvar url1 = \"https://hass.purgatoire.ca/local/reolinkring.jpg\";\nvar url2 = \"https://hass.purgatoire.ca/local/ring.jpg\";\nvar random = Date.now();\n\nvar newMsg = {\n\t\"payload\": {\n\t\t\"data\": {\n\t\t\t\"message\": \"Doorbell Alert\",\n\t\t\t\"title\": name + \" is at the door\",\n\t\t\t\"data\": {\n\t\t\t\t\"sticky\": 'true',\n\t\t\t\t\"clickAction\": '/phone-landing/reolink?kiosk=1',\n\t\t\t\t\"priority\": 'high',\n\t\t\t\t\"image\": url1 + \"?\" + random,\n\t\t\t\t\"actions\": [{\n\t\t\t\t\t\t\"action\": \"REPLY\",\n\t\t\t\t\t\t\"title\": \"Enter Text\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"action\": \"unlock_door\",\n\t\t\t\t\t\t\"title\": \"Unlock The Door\"\n\t\t\t\t\t}\n\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t}\n};\nreturn newMsg;",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 3220,
    "y": 3240,
    "wires": [
      [
        "b905934c3421b60e",
        "5ff3fb01d93f2688"
      ]
    ]
  },
  {
    "id": "929ec49d77f1d265",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "Save Reolink.jpg for notif",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "camera",
    "service": "snapshot",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "camera.front_door_go2rtc"
    ],
    "data": "{\"filename\":\"/config/www/reolinkring.jpg\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 2910,
    "y": 3200,
    "wires": [
      [
        "d221db1c2369290c",
        "31df4968113fd2ee",
        "345d1ac027df0ad5"
      ]
    ]
  },
  {
    "id": "31df4968113fd2ee",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "Notification setter Facecam",
    "func": "var name = \"Someone\";\nvar url = msg.responseUrl.split('?');\nvar urlfinal = url[1].replace('url=http://192.168.0.15:8123/','https://hass.purgatoire.ca/');\n\nvar newMsg = {\n\t\"payload\": {\n\t\t\"data\": {\n\t\t\t\"message\": \"Doorbell Alert\",\n\t\t\t\"title\": name + \" is at the door\",\n\t\t\t\"data\": {\n\t\t\t\t\"sticky\": 'true',\n\t\t\t\t\"clickAction\": '/phone-landing/reolink?kiosk=1',\n\t\t\t\t\"priority\": 'high',\n\t\t\t\t\"image\": urlfinal,\n\t\t\t\t\"actions\": [{\n\t\t\t\t\t\"action\": \"REPLY\",\n\t\t\t\t\t\"title\": \"Who is this?\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"action\": \"unlock_door\",\n\t\t\t\t\t\"title\": \"Unlock The Door\"\n\t\t\t\t}\n\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t}\n};\nreturn newMsg;\n",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 3180,
    "y": 3280,
    "wires": [
      [
        "5ff3fb01d93f2688",
        "6a8d0ed87f9ea5f6"
      ]
    ]
  },
  {
    "id": "d423506baddd2bd9",
    "type": "switch",
    "z": "cd7a606d7931c143",
    "name": "confidence over 80%?",
    "property": "match.confidence",
    "propertyType": "msg",
    "rules": [
      {
        "t": "gt",
        "v": "80",
        "vt": "num"
      },
      {
        "t": "lt",
        "v": "80",
        "vt": "num"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 2,
    "x": 2020,
    "y": 3120,
    "wires": [
      [
        "11605bc3d4a5768c"
      ],
      [
        "a3210f29da2f7d89"
      ]
    ]
  },
  {
    "id": "39ab114fdce7d727",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "Yes",
    "info": "",
    "x": 1770,
    "y": 3160,
    "wires": []
  },
  {
    "id": "bdd1de021e541a9b",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "No",
    "info": "",
    "x": 2150,
    "y": 3180,
    "wires": []
  },
  {
    "id": "b905934c3421b60e",
    "type": "change",
    "z": "cd7a606d7931c143",
    "name": "Set Data for mass alert",
    "rules": [
      {
        "t": "move",
        "p": "payload.data.title",
        "pt": "msg",
        "to": "message",
        "tot": "msg"
      },
      {
        "t": "set",
        "p": "color_value",
        "pt": "msg",
        "to": "[0,0,255]",
        "tot": "json"
      },
      {
        "t": "set",
        "p": "dbrigthness",
        "pt": "msg",
        "to": "100",
        "tot": "num"
      },
      {
        "t": "set",
        "p": "video",
        "pt": "msg",
        "to": "on",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 3500,
    "y": 3200,
    "wires": [
      [
        "46aa8fa7cc1812fe"
      ]
    ]
  },
  {
    "id": "46aa8fa7cc1812fe",
    "type": "subflow:233ac7dcd801a802",
    "z": "cd7a606d7931c143",
    "name": "",
    "x": 3730,
    "y": 3200,
    "wires": []
  },
  {
    "id": "8245e2c93a5a6520",
    "type": "api-current-state",
    "z": "cd7a606d7931c143",
    "name": "Acid time off",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "off",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "input_boolean.acid_time",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 2510,
    "y": 3100,
    "wires": [
      [
        "9e9926dbcd6718c4"
      ],
      [
        "c942ac776d6cd71f"
      ]
    ]
  },
  {
    "id": "9e9926dbcd6718c4",
    "type": "api-current-state",
    "z": "cd7a606d7931c143",
    "name": "kink off",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "off",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "input_boolean.kink_party",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "override_topic": false,
    "state_location": "payload",
    "override_payload": "msg",
    "entity_location": "data",
    "override_data": "msg",
    "x": 2680,
    "y": 3100,
    "wires": [
      [
        "9e9ec75f15412d60",
        "8b8cbeaffef4fdea"
      ],
      [
        "da73e5a65b916aaa"
      ]
    ]
  },
  {
    "id": "839c614fc03c226c",
    "type": "api-current-state",
    "z": "cd7a606d7931c143",
    "name": "Waiting Friend?",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "on",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "input_boolean.waiting_someone",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [
      {
        "property": "partyon",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      },
      {
        "property": "partydata",
        "propertyType": "msg",
        "value": "",
        "valueType": "entity"
      }
    ],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 2940,
    "y": 3140,
    "wires": [
      [
        "187a0a6344189bac"
      ],
      [
        "d1d80e74b4721828"
      ]
    ]
  },
  {
    "id": "9e9ec75f15412d60",
    "type": "api-current-state",
    "z": "cd7a606d7931c143",
    "name": "Party on",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "on",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "input_boolean.party_mode",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "override_topic": false,
    "state_location": "payload",
    "override_payload": "msg",
    "entity_location": "data",
    "override_data": "msg",
    "x": 2840,
    "y": 3060,
    "wires": [
      [
        "19ba7309e15502d7"
      ],
      [
        "839c614fc03c226c"
      ]
    ]
  },
  {
    "id": "379e425db7a8a166",
    "type": "api-current-state",
    "z": "cd7a606d7931c143",
    "name": "Waiting Uber off",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "off",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "input_boolean.waiting_uber",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 2320,
    "y": 3100,
    "wires": [
      [
        "8245e2c93a5a6520"
      ],
      [
        "749f9097f018277c"
      ]
    ]
  },
  {
    "id": "d86e08495bdfec13",
    "type": "api-current-state",
    "z": "cd7a606d7931c143",
    "name": "Front House Motion",
    "server": "7ab5c227.a3ce8c",
    "version": 3,
    "outputs": 2,
    "halt_if": "on",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "binary_sensor.motion_front",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [
      {
        "property": "partyon",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      },
      {
        "property": "partydata",
        "propertyType": "msg",
        "value": "",
        "valueType": "entity"
      }
    ],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 3210,
    "y": 3100,
    "wires": [
      [
        "3cb315d24a542bdd",
        "e8b98a63dc614820"
      ],
      [
        "d1d80e74b4721828"
      ]
    ]
  },
  {
    "id": "197c58d460754e34",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "debug 251",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 3750,
    "y": 3060,
    "wires": []
  },
  {
    "id": "487566f3cdab151e",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "No",
    "info": "",
    "x": 2310,
    "y": 3140,
    "wires": []
  },
  {
    "id": "bd09a8281cadc2cf",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "No",
    "info": "",
    "x": 2490,
    "y": 3140,
    "wires": []
  },
  {
    "id": "cb316946a26bcc8f",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "No",
    "info": "",
    "x": 2670,
    "y": 3140,
    "wires": []
  },
  {
    "id": "a28e789b76b73501",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "No",
    "info": "",
    "x": 3090,
    "y": 3140,
    "wires": []
  },
  {
    "id": "3cb315d24a542bdd",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "Notif setter",
    "func": "var name = msg.match.name\nvar url1 = \"https://hass.purgatoire.ca/local/reolinkring.jpg\";\nvar url2 = \"https://hass.purgatoire.ca/local/ring.jpg\";\nvar random = Date.now();\nvar cameraused = msg.match.camera;\n\nif (cameraused == \"faceshot_camera\") {\n\tvar usedurl = url2;\n}\nif (cameraused == \"front_door_camera\") {\n\tvar usedurl = url1;\n}\n\n\n\n\nvar newMsg = {\n\t\"payload\": {\n\t\t\"data\": {\n\t\t\t\"message\": \"Guest Alert\",\n\t\t\t\"title\": name + \" is being let in\",\n\t\t\t\"data\": {\n\t\t\t\t\"sticky\": 'true',\n\t\t\t\t\"clickAction\": '/phone-landing/reolink?kiosk=1',\n\t\t\t\t\"priority\": 'high',\n\t\t\t\t\"image\": usedurl + \"?\" + random,\n\t\t\t\t\"actions\": [{\n\t\t\t\t\t\"action\": \"REPLY\",\n\t\t\t\t\t\"title\": \"Enter Text\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"action\": \"unlock_door\",\n\t\t\t\t\t\"title\": \"Unlock The Door\"\n\t\t\t\t}\n\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t}\n};\nreturn newMsg;",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 3430,
    "y": 3120,
    "wires": [
      [
        "197c58d460754e34",
        "50c0e936582210bc",
        "d08abd3713730c8e"
      ]
    ]
  },
  {
    "id": "50c0e936582210bc",
    "type": "change",
    "z": "cd7a606d7931c143",
    "name": "Set Data for mass alert",
    "rules": [
      {
        "t": "move",
        "p": "payload.data.title",
        "pt": "msg",
        "to": "message",
        "tot": "msg"
      },
      {
        "t": "set",
        "p": "color_value",
        "pt": "msg",
        "to": "[200,200.0]",
        "tot": "json"
      },
      {
        "t": "set",
        "p": "dbrigthness",
        "pt": "msg",
        "to": "100",
        "tot": "num"
      },
      {
        "t": "set",
        "p": "video",
        "pt": "msg",
        "to": "on",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 3500,
    "y": 3160,
    "wires": [
      [
        "46aa8fa7cc1812fe"
      ]
    ]
  },
  {
    "id": "a58003ac74cf89ee",
    "type": "delay",
    "z": "cd7a606d7931c143",
    "name": "1M/S",
    "pauseType": "queue",
    "timeout": "5",
    "timeoutUnits": "seconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "second",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": true,
    "allowrate": false,
    "outputs": 1,
    "x": 3030,
    "y": 3080,
    "wires": [
      [
        "d86e08495bdfec13"
      ]
    ]
  },
  {
    "id": "b9f4bfaaf3a9a99a",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "unLock Door",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "lock",
    "service": "unlock",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "lock.lock_front_door"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 2970,
    "y": 2960,
    "wires": [
      [
        "dd81beb95daf3bac",
        "5f28a51d294cc4e3"
      ]
    ]
  },
  {
    "id": "dd81beb95daf3bac",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "unlock",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 3110,
    "y": 2920,
    "wires": []
  },
  {
    "id": "5f28a51d294cc4e3",
    "type": "ha-wait-until",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 2,
    "outputs": 2,
    "entityId": "lock.lock_front_door",
    "entityIdFilterType": "exact",
    "property": "state",
    "comparator": "is",
    "value": "unlocked",
    "valueType": "str",
    "timeout": "2",
    "timeoutType": "num",
    "timeoutUnits": "minutes",
    "checkCurrentState": true,
    "blockInputOverrides": true,
    "outputProperties": [],
    "x": 3120,
    "y": 2960,
    "wires": [
      [
        "e165660ed48ac3d0"
      ],
      []
    ]
  },
  {
    "id": "dda34bae7cf620ec",
    "type": "ha-wait-until",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 2,
    "outputs": 2,
    "entityId": "lock.lock_front_door",
    "entityIdFilterType": "exact",
    "property": "state",
    "comparator": "is",
    "value": "locked",
    "valueType": "str",
    "timeout": "30",
    "timeoutType": "num",
    "timeoutUnits": "seconds",
    "checkCurrentState": true,
    "blockInputOverrides": true,
    "outputProperties": [],
    "x": 3460,
    "y": 2960,
    "wires": [
      [
        "3e60e8997224cfa6"
      ],
      [
        "3e60e8997224cfa6"
      ]
    ]
  },
  {
    "id": "3e60e8997224cfa6",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "toggle boolean",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "homeassistant",
    "service": "turn_off",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_boolean.face_recognized",
      "input_boolean.waiting_someone"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 3640,
    "y": 2960,
    "wires": [
      [
        "c6595ae3eda7a8eb"
      ]
    ]
  },
  {
    "id": "c6595ae3eda7a8eb",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "input_text",
    "service": "set_value",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_text.recognized_face"
    ],
    "data": " {             \"value\": \"UNKNOWN\"         }",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 3850,
    "y": 2960,
    "wires": [
      []
    ]
  },
  {
    "id": "e8b98a63dc614820",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "Name Payload",
    "func": "var name = msg.match.name;\n\nvar newMsg = {\n    \"payload\": {\n        \"data\": {\n            \"value\": name\n        }}};\nreturn newMsg;\n",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 3320,
    "y": 3020,
    "wires": [
      [
        "9ebcbf82e5caf5f3"
      ]
    ]
  },
  {
    "id": "9ebcbf82e5caf5f3",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "input_text",
    "service": "set_value",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_text.recognized_face"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 3520,
    "y": 3020,
    "wires": [
      [
        "2f033ae37ad81487"
      ]
    ]
  },
  {
    "id": "e165660ed48ac3d0",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "toggle boolean",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "homeassistant",
    "service": "turn_on",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_boolean.face_recognized"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 3280,
    "y": 2960,
    "wires": [
      [
        "dda34bae7cf620ec"
      ]
    ]
  },
  {
    "id": "2f033ae37ad81487",
    "type": "trigger",
    "z": "cd7a606d7931c143",
    "name": "",
    "op1": "1",
    "op2": "",
    "op1type": "str",
    "op2type": "nul",
    "duration": "250",
    "extend": false,
    "overrideDelay": false,
    "units": "ms",
    "reset": "",
    "bytopic": "all",
    "topic": "topic",
    "outputs": 1,
    "x": 3040,
    "y": 3020,
    "wires": [
      [
        "b9f4bfaaf3a9a99a"
      ]
    ]
  },
  {
    "id": "57143d0acb9869ee",
    "type": "comment",
    "z": "cd7a606d7931c143",
    "name": "No",
    "info": "",
    "x": 2850,
    "y": 3100,
    "wires": []
  },
  {
    "id": "d08abd3713730c8e",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "notify",
    "service": "mobile_app_phone_fold4",
    "areaId": [],
    "deviceId": [],
    "entityId": [],
    "data": "{\"message\":\"Bedroom door open\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 3770,
    "y": 3120,
    "wires": [
      []
    ]
  },
  {
    "id": "5ff3fb01d93f2688",
    "type": "api-call-service",
    "z": "cd7a606d7931c143",
    "name": "",
    "server": "7ab5c227.a3ce8c",
    "version": 5,
    "debugenabled": false,
    "domain": "notify",
    "service": "mobile_app_phone_fold4",
    "areaId": [],
    "deviceId": [],
    "entityId": [],
    "data": "{\"message\":\"Bedroom door open\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 3530,
    "y": 3280,
    "wires": [
      []
    ]
  },
  {
    "id": "7e7da62b1bae7963",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "Javascript",
    "func": "var d = new Date();\nvar name = msg.payload.name;\nvar m = d.getMilliseconds();\nvar snapshot = msg.payload.data.filename;\nvar url = \"http://192.168.0.12:8765/picture/8/current/?\" + m;\n\nvar snapshot = snapshot.replace(\"\\/config\\/www\",\"https:\\/\\/hass.purgatoire.ca\\/local\");\n\n\nvar newMsg = {\n\t\"payload\": {\n\t\t\"data\": {\n\t\t\t\"message\": \"Doorbell Alert\",\n\t\t\t\"title\": name + \" is at the door\",\n\t\t\t\"data\": {\n\t\t\t\t\"image\": snapshot,\n\t\t\t\t\"actions\": [{\n\t\t\t\t\t\t\"action\": \"REPLY\",\n\t\t\t\t\t\t\"title\": \"Who is this?\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"action\": \"unlock_door\",\n\t\t\t\t\t\t\"title\": \"Unlock The Door\"\n\t\t\t\t\t}\n\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t}\n};\nreturn newMsg;",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 2720,
    "y": 3360,
    "wires": [
      []
    ]
  },
  {
    "id": "6a8d0ed87f9ea5f6",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "debug 252",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 3410,
    "y": 3340,
    "wires": []
  },
  {
    "id": "345d1ac027df0ad5",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "debug 253",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 3150,
    "y": 3180,
    "wires": []
  },
  {
    "id": "dcce339bc693f919",
    "type": "inject",
    "z": "cd7a606d7931c143",
    "name": "",
    "props": [
      {
        "p": "payload"
      },
      {
        "p": "topic",
        "vt": "str"
      },
      {
        "p": "event_type",
        "v": "mobile_app_notification_action",
        "vt": "str"
      }
    ],
    "repeat": "",
    "crontab": "",
    "once": false,
    "onceDelay": 0.1,
    "topic": "mobile_app_notification_action",
    "payload": "{\"event_type\":\"mobile_app_notification_action\",\"event\":{\"action_2_title\":\"Unlock The Door\",\"sticky\":\"true\",\"image\":\"https://hass.purgatoire.ca/local/1682889557657.jpg\",\"title\":\"Someone is at the door\",\"webhook_id\":\"dc5b17a37680a99a6d5a4bec876571290bc9540b3eb9cdcb19aa3f9b40d898ab\",\"clickAction\":\"/phone-landing/reolink?kiosk=1\",\"message\":\"Doorbell Alert\",\"action_1_title\":\"Who is this?\",\"action_1_key\":\"REPLY\",\"action_2_key\":\"unlock_door\",\"server_id\":\"2\",\"reply_text\":\"Maxi\",\"action\":\"REPLY\",\"device_id\":\"abe9267b23414bbb\"},\"origin\":\"REMOTE\",\"time_fired\":\"2023-04-30T21:25:08.972910+00:00\",\"context\":{\"id\":\"01GZA0W8QC3AG77H5AHK50AE15\",\"parent_id\":null,\"user_id\":\"7f1de31122574f6fa2215e519d6083ea\"}}",
    "payloadType": "json",
    "x": 930,
    "y": 2640,
    "wires": [
      [
        "315f5569a3cd1e1f",
        "df207d122707860f"
      ]
    ]
  },
  {
    "id": "f0ec839492a6cc22",
    "type": "exec",
    "z": "cd7a606d7931c143",
    "command": "",
    "addpay": "command",
    "append": "",
    "useSpawn": "false",
    "timer": "",
    "winHide": false,
    "oldrc": false,
    "name": "Command wget ",
    "x": 1660,
    "y": 2700,
    "wires": [
      [
        "4d1544ef1ac3d09e",
        "66870ae54d415f31"
      ],
      [],
      []
    ]
  },
  {
    "id": "3342da11fe49855e",
    "type": "function",
    "z": "cd7a606d7931c143",
    "name": "Javascript",
    "func": "var image = msg.payload.event.image;\nvar name = msg.payload.event.reply_text;\nvar newMsg = {\n    \"command\": \"mkdir \" + \"/config/www/doubletake/\" + name + \";wget \" + image  + \" -P /config/www/doubletake/\" + name,\n    \"data\": msg.payload\n};\nreturn newMsg;\n",
    "outputs": 1,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 1480,
    "y": 2700,
    "wires": [
      [
        "f6222dfaaa9dc9b0",
        "f0ec839492a6cc22"
      ]
    ]
  },
  {
    "id": "f6222dfaaa9dc9b0",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "actionable",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 1550,
    "y": 2760,
    "wires": []
  },
  {
    "id": "4d1544ef1ac3d09e",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 1730.9090576171875,
    "y": 2636.363525390625,
    "wires": []
  },
  {
    "id": "c8a2221e9878688b",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 2070,
    "y": 2660,
    "wires": []
  },
  {
    "id": "1f14ea34c73aed0f",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 2290,
    "y": 2640,
    "wires": []
  },
  {
    "id": "1832a1b9f4db63f9",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 2750,
    "y": 2560,
    "wires": []
  },
  {
    "id": "9bdca88a7d4fd421",
    "type": "server-state-changed",
    "z": "cd7a606d7931c143",
    "name": "Doorbell",
    "server": "7ab5c227.a3ce8c",
    "version": 4,
    "outputs": 2,
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "ignorePrevStateNull": true,
    "ignorePrevStateUnknown": true,
    "ignorePrevStateUnavailable": true,
    "ignoreCurrentStateUnknown": true,
    "ignoreCurrentStateUnavailable": true,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      },
      {
        "property": "data",
        "propertyType": "msg",
        "value": "",
        "valueType": "eventData"
      },
      {
        "property": "topic",
        "propertyType": "msg",
        "value": "",
        "valueType": "triggerId"
      }
    ],
    "exposeToHomeAssistant": false,
    "haConfig": [
      {
        "property": "name",
        "value": ""
      },
      {
        "property": "icon",
        "value": ""
      }
    ],
    "entityidfilter": "sensor.remote_doorbell_button_action",
    "entityidfiltertype": "exact",
    "outputinitially": false,
    "state_type": "str",
    "haltifstate": "single",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "output_only_on_state_change": true,
    "x": 100,
    "y": 3180,
    "wires": [
      [
        "6a37007e21a4e0d1",
        "8e6d0b4579baf31a",
        "8d277ccd6bea87cf"
      ],
      []
    ]
  },
  {
    "id": "8d277ccd6bea87cf",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "debug 254",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "false",
    "statusVal": "",
    "statusType": "auto",
    "x": 290,
    "y": 3120,
    "wires": []
  },
  {
    "id": "b6978e3cb658ead3",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "debug 255",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 1410,
    "y": 3320,
    "wires": []
  },
  {
    "id": "6fbc1313b7294867",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "debug 256",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 790,
    "y": 3300,
    "wires": []
  },
  {
    "id": "7c6da2fd4be43b11",
    "type": "debug",
    "z": "cd7a606d7931c143",
    "name": "",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "targetType": "full",
    "statusVal": "",
    "statusType": "auto",
    "x": 2510,
    "y": 2640,
    "wires": []
  }
]